<html><style>body {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
h1, h2, h3, h4, h5, h6 {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
table, pre {
color: #000000;
background-color: #FFFFFF;
font-size: 16;
font-family: Serif;
font-weight: normal;
font-style: normal;
}

ul, #myUL {
  list-style-type: none;
}

#myUL {
  margin: 0;
  padding: 0;
}

.caret, .dropDownCaret {
  cursor: pointer;
}

.caret::before {
	content: "\25B6";
	color: black;
	display: inline - block;
	margin - right: 6px;
}

.dropDownCaret::before {
	content: "\25BC";
	color: black;
	display: inline - block;
	margin - right: 6px;
	float: right;
}


.nested {
  display: none;
}

.active {
  display: block;
}
</style><body><br></br><h1><div>Power BI Documentation</div></h1><br></br><hr></hr><h2><div>Generated by <a href="http://radacad.com/power-bi-helper">Power BI Helper</a> (Copyright &copy; <a href="http://radacad.com">RADACAD</a>).</div><br></br><div>Date: 03/02/2023 15:31:18</div><br></br></h2><h1><div>------------------******   Visualization    ******---------------------</div></h1><br></br><h2><div>File: ENTRADAS.pbix</div></h2><br></br><h3><div>Path: G:\Meu Drive\DATAMAX\PBIXs\Qualidade\APP2\ENTRADAS.pbix</div></h2><br></br><h1><div>------------------******   Model    ******---------------------</div></h1><br></br><h2><div>Model: ENTRADAS</div></h2><br></br><hr></hr><br></br><h3><div>List of Tables:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >Description</td><td >Storage Mode</td><td >Source</td><td >Is Hidden</td></tr><tr ><td >Mapa de Entrada</td><td ></td><td >Import</td><td ><pre>let
    Fonte = AmazonRedshift.Database("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com","farmaxcluster"),
    qlt = Fonte{[Name="qlt"]}[Data],
    dim_product_input_map1 = qlt{[Name="dim_product_input_map"]}[Data],
    #"Linhas Filtradas" = Table.SelectRows(dim_product_input_map1, each ([product_input_map_nm_center] = "FARM")),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Linhas Filtradas",{{"product_input_map_nm_center", "CENTRO"},{"product_input_map_cd_product", "COD MATERIAL"}, {"product_input_map_dc_product", "DESC MATERIAL"}, {"product_input_map_dc_unity", "UN"}, {"product_input_map_cd_reference", "NF"}, {"product_input_map_dt_launch_date", "DT LANÇAMENTO"}, {"product_input_map_cd_provider", "COD FORNECEDOR"}, {"product_input_map_nm_provider", "FORNECEDOR"}, {"product_input_map_dt_production_date", "DT PRODUÇÃO"}, {"product_input_map_cd_batch", "LOTE"}, {"product_input_map_dt_due_date", "DT VENCIMENTO"}, {"product_input_map_tp_material", "TIPO MATERIAL"}, {"product_input_map_qt_product", "QTD"}}),
    #"Tipo Alterado" = Table.TransformColumnTypes(#"Colunas Renomeadas",{{"COD MATERIAL", type text}})
in
    #"Tipo Alterado"</pre></td><td >False</td></tr><tr ><td >Última Atualização</td><td ></td><td >Import</td><td ><pre>let
    Fonte = DateTimeZone.SwitchZone(DateTimeZone.LocalNow(),-4,0)
in
    Fonte</pre></td><td >False</td></tr><tr ><td >_Medidas</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText("i44FAA==", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#"Coluna 1" = _t]),
    #"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Coluna 1", type text}}),
    #"Colunas Removidas" = Table.RemoveColumns(#"Tipo Alterado",{"Coluna 1"})
in
    #"Colunas Removidas"</pre></td><td >False</td></tr><tr ><td >dCalendario</td><td ></td><td >Import</td><td ><pre>ADDCOLUMNS(
   CALENDARAUTO(),
    "Ano",YEAR([Date]),
    "TrimNum",QUARTER([Date]),
    "Trim",CONCATENATE("Trim-",QUARTER([Date])),
    "MesNum",MONTH([Date]),
    "Mês",FORMAT([Date],"mmm"),
    "Dia_Num",DAY([Date]),
    "DiadaSemanNum",WEEKDAY([Date],1),
    "Dia da Semana",FORMAT([Date],"ddd"),
    "Dia", CONCATENATE("",DAY([Date])))//Coluna criada para ordenar os dias nos visuais de período</pre></td><td >False</td></tr><tr ><td >Parâmetro - TOP N</td><td ></td><td >Import</td><td ><pre>GENERATESERIES(1, 10, 1)</pre></td><td >False</td></tr><tr ><td >Parâmetro - DT VALIDADE</td><td ></td><td >Import</td><td ><pre>{
    ("Ano", NAMEOF('dCalendario'[Ano]), 0,"Ano"),
    ("Trim", NAMEOF('dCalendario'[Trim]), 1,"Trimestre"),
    ("Mês", NAMEOF('dCalendario'[Mês]), 2,"Mês"),
    ("Dia", NAMEOF('dCalendario'[Dia]), 3,"Dia"),
    ("Dia da Semana", NAMEOF('dCalendario'[Dia da Semana]), 4,"Dia da Semana")
}</pre></td><td >False</td></tr></table><hr></hr><br></br><h3><div>List of Measures:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Measure Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
		<th>Dependency</th>
		<th>Reverse Dependency</th>
	</tr>
	<tr>
		<td>01_Total Entradas</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>COUNT ( 'Mapa de Entrada'[COD MATERIAL] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 01_Total Entradas</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 01_Total Entradas</span><span class="dropDownCaret">
<ul class="nested">
<li>Measure: 03_Mat em Dia</li>
<li>Measure: 05_Mat Sem Vencimento</li>
<li>Measure: 04_Mat Vencidos</li>
<li>Measure: 07_Destacar Maior Valor De Vencimento</li>
<li><span class="caret">Measure: 08_TOP N Fornecedores</span>
<ul class="nested">
<li>Measure: 10_Destacar Maior Fornecedor Entradas</li>
</ul></li>
<li><span class="caret">Measure: 09_TOP N Materiais</span>
<ul class="nested">
<li>Measure: 11_Destacar Maior Materiais Entradas</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>02_Total Nfe</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( 'Mapa de Entrada'[NF] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 02_Total Nfe</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: NF (Table: Mapa de Entrada)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 02_Total Nfe</td>
	</tr>
	<tr>
		<td>03_Mat em Dia</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total Entradas],
    'Mapa de Entrada'[STATUS VALIDADE] = "Em dia"
) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 03_Mat em Dia</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li><span class="caret">Measure: 01_Total Entradas (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></li>
<li><span class="caret">Calc_Column: STATUS VALIDADE (Table: Mapa de Entrada)</span>
<ul class="nested">
<li>Table: Mapa de Entrada   ...</li>
<li><span class="caret">Calc_Column: DIAS VENCIMENTO (Table: Mapa de Entrada)</span>
<ul class="nested">
<li>Table: Mapa de Entrada   ...</li>
<li>Column: DT VENCIMENTO (Table: Mapa de Entrada)</li>
</ul></li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 03_Mat em Dia</td>
	</tr>
	<tr>
		<td>05_Mat Sem Vencimento</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total Entradas],
    'Mapa de Entrada'[STATUS VALIDADE] = "Sem vencimento"
) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 05_Mat Sem Vencimento</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li><span class="caret">Measure: 01_Total Entradas (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></li>
<li><span class="caret">Calc_Column: STATUS VALIDADE (Table: Mapa de Entrada)</span>
<ul class="nested">
<li>Table: Mapa de Entrada   ...</li>
<li><span class="caret">Calc_Column: DIAS VENCIMENTO (Table: Mapa de Entrada)</span>
<ul class="nested">
<li>Table: Mapa de Entrada   ...</li>
<li>Column: DT VENCIMENTO (Table: Mapa de Entrada)</li>
</ul></li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 05_Mat Sem Vencimento</td>
	</tr>
	<tr>
		<td>06_Total Fornecedores</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( 'Mapa de Entrada'[COD FORNECEDOR] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 06_Total Fornecedores</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD FORNECEDOR (Table: Mapa de Entrada)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 06_Total Fornecedores</td>
	</tr>
	<tr>
		<td>04_Mat Vencidos</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total Entradas],
    'Mapa de Entrada'[STATUS VALIDADE] = "Vencido"
) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 04_Mat Vencidos</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li><span class="caret">Measure: 01_Total Entradas (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></li>
<li><span class="caret">Calc_Column: STATUS VALIDADE (Table: Mapa de Entrada)</span>
<ul class="nested">
<li>Table: Mapa de Entrada   ...</li>
<li><span class="caret">Calc_Column: DIAS VENCIMENTO (Table: Mapa de Entrada)</span>
<ul class="nested">
<li>Table: Mapa de Entrada   ...</li>
<li>Column: DT VENCIMENTO (Table: Mapa de Entrada)</li>
</ul></li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 04_Mat Vencidos</td>
	</tr>
	<tr>
		<td>Periodo Entrada</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Período Entrada de Materiais: "
    & MIN ( 'Mapa de Entrada'[DT LANÇAMENTO] ) & " a "
    & MAX ( 'Mapa de Entrada'[DT LANÇAMENTO] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Periodo Entrada</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: DT LANÇAMENTO (Table: Mapa de Entrada)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Periodo Entrada</td>
	</tr>
	<tr>
		<td>07_Destacar Maior Valor De Vencimento</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>VAR COR_DESTAQUE = "#094780"
VAR COR_PADRAO = "#CCD5EB"
VAR VMAIORANO =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Ano] ),
            [01_Total Entradas]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORTRI =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Trim] ),
            [01_Total Entradas]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORMES =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Mês] ),
            [01_Total Entradas]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORDIA =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Dia] ),
            [01_Total Entradas]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORDIADASEMANA =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Dia da Semana] ),
            [01_Total Entradas]
        ),
        ALLSELECTED ( dCalendario )
    )
RETURN
    SWITCH (
        TRUE (),
        [01_Total Entradas] = VMAIORANO, COR_DESTAQUE,
        [01_Total Entradas] = VMAIORMES, COR_DESTAQUE,
        [01_Total Entradas] = VMAIORTRI, COR_DESTAQUE,
        [01_Total Entradas] = VMAIORDIA, COR_DESTAQUE,
        [01_Total Entradas] = VMAIORDIADASEMANA, COR_DESTAQUE,
        COR_PADRAO
    )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 07_Destacar Maior Valor De Vencimento</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: 01_Total Entradas (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario (Table: dCalendario)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: DT LANÇAMENTO (Table: Mapa de Entrada)</li>
<li>Column: DT PRODUÇÃO (Table: Mapa de Entrada)</li>
<li>Column: DT VENCIMENTO (Table: Mapa de Entrada)</li>
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li>Calc_Column: Ano (Table: dCalendario)</li>
<li><span class="caret">Calc_Column: Trim (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: TrimNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: Dia_Num (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia da Semana (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: DiadaSemanNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Mês (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: MesNum (Table: dCalendario)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 07_Destacar Maior Valor De Vencimento</td>
	</tr>
	<tr>
		<td>14_T&#237;tulo Validade Materiais</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Total de Materiais por Período da Validade "
    & SELECTEDVALUE ( 'Parâmetro - DT VALIDADE'[Value4] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 14_Título Validade Materiais</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - DT VALIDADE (Table: Parâmetro - DT VALIDADE)</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario (Table: dCalendario)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: DT LANÇAMENTO (Table: Mapa de Entrada)</li>
<li>Column: DT PRODUÇÃO (Table: Mapa de Entrada)</li>
<li>Column: DT VENCIMENTO (Table: Mapa de Entrada)</li>
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li>Calc_Column: Ano (Table: dCalendario)</li>
<li><span class="caret">Calc_Column: Trim (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: TrimNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: Dia_Num (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia da Semana (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: DiadaSemanNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Mês (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: MesNum (Table: dCalendario)</li>
</ul></li>
<li>Attribute_Hierarchy: Parâmetro - DT VALIDADA Pedido (Table: Parâmetro - DT VALIDADE)</li>
</ul></li>
<li>Calc_Column: Value4 (Table: Parâmetro - DT VALIDADE)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 14_Título Validade Materiais</td>
	</tr>
	<tr>
		<td>08_TOP N Fornecedores</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total Entradas],
    KEEPFILTERS (
        TOPN (
            'Parâmetro - TOP N'[Parâmetro - TOP N Valor],
            ALL ( 'Mapa de Entrada'[FORNECEDOR] ),
            [01_Total Entradas]
        )
    )
) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 08_TOP N Fornecedores</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: FORNECEDOR (Table: Mapa de Entrada)</li>
<li><span class="caret">Measure: 01_Total Entradas (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></li>
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li><span class="caret">Measure: Parâmetro - TOP N Valor (Table: Parâmetro - TOP N)</span>
<ul class="nested">
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li>Calc_Column: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 08_TOP N Fornecedores</span><span class="dropDownCaret">
<ul class="nested">
<li>Measure: 10_Destacar Maior Fornecedor Entradas</li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>09_TOP N Materiais</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total Entradas],
    KEEPFILTERS (
        TOPN (
            'Parâmetro - TOP N'[Parâmetro - TOP N Valor],
            ALL ( 'Mapa de Entrada'[DESC MATERIAL] ),
            [01_Total Entradas]
        )
    )
)</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 09_TOP N Materiais</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: DESC MATERIAL (Table: Mapa de Entrada)</li>
<li><span class="caret">Measure: 01_Total Entradas (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></li>
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li><span class="caret">Measure: Parâmetro - TOP N Valor (Table: Parâmetro - TOP N)</span>
<ul class="nested">
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li>Calc_Column: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 09_TOP N Materiais</span><span class="dropDownCaret">
<ul class="nested">
<li>Measure: 11_Destacar Maior Materiais Entradas</li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>10_Destacar Maior Fornecedor Entradas</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>VAR vMaiorFornecedor =
    CALCULATE (
        MAXX (
            VALUES ( 'Mapa de Entrada'[FORNECEDOR] ),
            [08_TOP N Fornecedores]
        ),
        ALLSELECTED ( 'Mapa de Entrada' )
    )
RETURN
    SWITCH (
        TRUE (),
        [08_TOP N Fornecedores] = vMaiorFornecedor, "#094780",
        "#CCD5EB"
    )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 10_Destacar Maior Fornecedor Entradas</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: FORNECEDOR (Table: Mapa de Entrada)</li>
<li><span class="caret">Measure: 08_TOP N Fornecedores (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: FORNECEDOR (Table: Mapa de Entrada)</li>
<li><span class="caret">Measure: 01_Total Entradas (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></li>
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li><span class="caret">Measure: Parâmetro - TOP N Valor (Table: Parâmetro - TOP N)</span>
<ul class="nested">
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li>Calc_Column: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
</ul></li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 10_Destacar Maior Fornecedor Entradas</td>
	</tr>
	<tr>
		<td>11_Destacar Maior Materiais Entradas</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>VAR vMaiorMaterial =
    CALCULATE (
        MAXX (
            VALUES ( 'Mapa de Entrada'[DESC MATERIAL] ),
            [09_TOP N Materiais]
        ),
        ALLSELECTED ( 'Mapa de Entrada' )
    )
RETURN
    SWITCH (
        TRUE (),
        [09_TOP N Materiais] = vMaiorMaterial, "#094780",
        "#CCD5EB"
    )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 11_Destacar Maior Materiais Entradas</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: DESC MATERIAL (Table: Mapa de Entrada)</li>
<li><span class="caret">Measure: 09_TOP N Materiais (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: DESC MATERIAL (Table: Mapa de Entrada)</li>
<li><span class="caret">Measure: 01_Total Entradas (Table: _Medidas)</span>
<ul class="nested">
<li>Table: Mapa de Entrada</li>
<li>Column: COD MATERIAL (Table: Mapa de Entrada)</li>
</ul></li>
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li><span class="caret">Measure: Parâmetro - TOP N Valor (Table: Parâmetro - TOP N)</span>
<ul class="nested">
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li>Calc_Column: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
</ul></li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 11_Destacar Maior Materiais Entradas</td>
	</tr>
	<tr>
		<td>12_T&#237;tulo TOP N Fornecedores</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Top "
    & SELECTEDVALUE ( 'Parâmetro - TOP N'[Parâmetro - TOP N] ) & " Fornecedores por Total de Entradas"</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 12_Título TOP N Fornecedores</span><span class="dropDownCaret">
<ul class="nested">
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li>Calc_Column: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 12_Título TOP N Fornecedores</td>
	</tr>
	<tr>
		<td>13_T&#237;tulo TOP N Materiais</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Top "
    & SELECTEDVALUE ( 'Parâmetro - TOP N'[Parâmetro - TOP N] ) & " Materiais por Total de Entradas"</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 13_Título TOP N Materiais</span><span class="dropDownCaret">
<ul class="nested">
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li>Calc_Column: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 13_Título TOP N Materiais</td>
	</tr>
	<tr>
		<td>&#218;ltima atualiza&#231;&#227;o</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Última atualização agendada: "
    & SELECTEDVALUE ( 'Última Atualização'[Última Atualização] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Última atualização</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Última atualização</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - DT VALIDADE</span>
<ul class="nested">
<li>Measure: 14_Título Validade Materiais</li>
</ul></li>
<li>Measure: 07_Destacar Maior Valor De Vencimento</li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - DT VALIDADE</span>
<ul class="nested">
<li>Measure: 14_Título Validade Materiais</li>
</ul></li>
<li>Measure: 07_Destacar Maior Valor De Vencimento</li>
</ul></li>
<li><span class="caret">Measure: Última atualização</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - DT VALIDADE</span>
<ul class="nested">
<li>Measure: 14_Título Validade Materiais</li>
</ul></li>
<li>Measure: 07_Destacar Maior Valor De Vencimento</li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - DT VALIDADE</span>
<ul class="nested">
<li>Measure: 14_Título Validade Materiais</li>
</ul></li>
<li>Measure: 07_Destacar Maior Valor De Vencimento</li>
</ul></li>
<li>Measure: Última atualização ...</li>
<li>Measure: Última atualização ...</li>
</ul></li>
<li><span class="caret">Measure: Última atualização</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - DT VALIDADE</span>
<ul class="nested">
<li>Measure: 14_Título Validade Materiais</li>
</ul></li>
<li>Measure: 07_Destacar Maior Valor De Vencimento</li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - DT VALIDADE</span>
<ul class="nested">
<li>Measure: 14_Título Validade Materiais</li>
</ul></li>
<li>Measure: 07_Destacar Maior Valor De Vencimento</li>
</ul></li>
<li>Measure: Última atualização ...</li>
<li>Measure: Última atualização ...</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>Par&#226;metro - TOP N Valor</td>
		<td>Par&#226;metro - TOP N</td>
		<td></td>
		<td><pre>SELECTEDVALUE (
    'Parâmetro - TOP N'[Parâmetro - TOP N],
    10
)</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Parâmetro - TOP N Valor</span><span class="dropDownCaret">
<ul class="nested">
<li>Calc_Table: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
<li>Calc_Column: Parâmetro - TOP N (Table: Parâmetro - TOP N)</li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Parâmetro - TOP N Valor</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: 08_TOP N Fornecedores</span>
<ul class="nested">
<li>Measure: 10_Destacar Maior Fornecedor Entradas</li>
</ul></li>
<li><span class="caret">Measure: 09_TOP N Materiais</span>
<ul class="nested">
<li>Measure: 11_Destacar Maior Materiais Entradas</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Mapa de Entrada:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>CENTRO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>COD MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DESC MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>UN</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>product_input_map_doc_material</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>NF</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DT LAN&#199;AMENTO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>COD FORNECEDOR</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>FORNECEDOR</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DT PRODU&#199;&#195;O</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DT VENCIMENTO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TIPO MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>LOTE</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>QTD</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DIAS VENCIMENTO</td>
		<td></td>
		<td>Calculated Column</td>
		<td>IF(ISBLANK(&#39;Mapa de Entrada&#39;[DT VENCIMENTO]),BLANK(),&#39;Mapa de Entrada&#39;[DT VENCIMENTO]-TODAY())</td>
	</tr>
	<tr>
		<td>STATUS VALIDADE</td>
		<td></td>
		<td>Calculated Column</td>
		<td>IF(
        ISBLANK(&#39;Mapa de Entrada&#39;[DIAS VENCIMENTO]),&quot;Sem Vencimento&quot;,
        IF(&#39;Mapa de Entrada&#39;[DIAS VENCIMENTO] &lt; 0, &quot;Vencido&quot;
        , &quot;Em dia&quot;))</td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Última Atualização:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>&#218;ltima Atualiza&#231;&#227;o</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table _Medidas:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table dCalendario:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Date</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Ano</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TrimNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Trim</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>MesNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DiadaSemanNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia da Semana</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>M&#234;s</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia_Num</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Parâmetro - TOP N:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Par&#226;metro - TOP N</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Parâmetro - DT VALIDADE:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Par&#226;metro - DT VALIDADE</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Value4</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Roles:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Role Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>Relationships:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >CrossFilteringBehavior</td><td >FromCardinality</td><td >FromColumn</td><td >FromTable</td><td >IsActive</td><td >IsRemoved</td><td >JoinOnDateBehavior</td><td >RelyOnReferentialIntegrity</td><td >SecurityFilteringBehavior</td><td >State</td><td >ToCardinality</td><td >ToColumn</td><td >ToTable</td><td >Type</td></tr><tr ><td >0cbc34fe-352a-43c5-8823-628c9e6aa58f</td><td >OneDirection</td><td >Many</td><td >DT VENCIMENTO</td><td >Mapa de Entrada</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Date</td><td >dCalendario</td><td >SingleColumn</td></tr></table><hr></hr><br></br><h2><div>M (Power Query) Script:</div></h2><br></br><br></br><font face="verdana" size="2"<div>Mapa de Entrada-1602f76c-4c87-4689-ac43-92e1cca53c2a<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">AmazonRedshift.Database</font>("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com<font color="red">","</font>farmaxcluster"),<br></br>    qlt = Fonte{[Name=<font color="red">"qlt"</font>]}[Data],<br></br>    dim_product_input_map1 = qlt{[Name=<font color="red">"dim_product_input_map"</font>]}[Data],<br></br>    #<font color="red">"Linhas Filtradas"</font> = <font color="purple">Table.SelectRows</font>(dim_product_input_map1, each ([product_input_map_nm_center] = <font color="red">"FARM"</font>)),<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Linhas Filtradas"</font>,{{<font color="red">"product_input_map_nm_center"</font>, <font color="red">"CENTRO"</font>},{<font color="red">"product_input_map_cd_product"</font>, <font color="red">"COD MATERIAL"</font>}, {<font color="red">"product_input_map_dc_product"</font>, <font color="red">"DESC MATERIAL"</font>}, {<font color="red">"product_input_map_dc_unity"</font>, <font color="red">"UN"</font>}, {<font color="red">"product_input_map_cd_reference"</font>, <font color="red">"NF"</font>}, {<font color="red">"product_input_map_dt_launch_date"</font>, <font color="red">"DT LANÇAMENTO"</font>}, {<font color="red">"product_input_map_cd_provider"</font>, <font color="red">"COD FORNECEDOR"</font>}, {<font color="red">"product_input_map_nm_provider"</font>, <font color="red">"FORNECEDOR"</font>}, {<font color="red">"product_input_map_dt_production_date"</font>, <font color="red">"DT PRODUÇÃO"</font>}, {<font color="red">"product_input_map_cd_batch"</font>, <font color="red">"LOTE"</font>}, {<font color="red">"product_input_map_dt_due_date"</font>, <font color="red">"DT VENCIMENTO"</font>}, {<font color="red">"product_input_map_tp_material"</font>, <font color="red">"TIPO MATERIAL"</font>}, {<font color="red">"product_input_map_qt_product"</font>, <font color="red">"QTD"</font>}}),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Colunas Renomeadas"</font>,{{<font color="red">"COD MATERIAL"</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Tipo Alterado"</font><br></br><br></br><br></br>----------------------<br></br>Última Atualização-3dcf9b3e-a2e0-4ae6-b884-3662e2205a04<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">DateTimeZone.SwitchZone</font>(<font color="purple">DateTimeZone.LocalNow</font>(),-4,0)<br></br><font color="blue">in</font><br></br>    Fonte<br></br><br></br><br></br>----------------------<br></br>_Medidas-3e8375a7-9015-43a4-8dbb-d1660fa0dd98<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i44FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Coluna 1"</font> = _t]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Coluna 1"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Tipo Alterado"</font>,{<font color="red">"Coluna 1"</font>})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Removidas"</font><br></br><br></br><br></br>----------------------<br></br>dCalendario-ee8a98c6-efae-4060-9ab5-9fcf3ba08f48<br></br><br></br>ADDCOLUMNS(<br></br>   CALENDARAUTO(),<br></br>    <font color="red">"Ano"</font>,YEAR([Date]),<br></br>    <font color="red">"TrimNum"</font>,QUARTER([Date]),<br></br>    <font color="red">"Trim"</font>,CONCATENATE("Trim-",QUARTER([Date])),<br></br>    <font color="red">"MesNum"</font>,MONTH([Date]),<br></br>    <font color="red">"Mês"</font>,FORMAT([Date],<font color="red">"mmm"</font>),<br></br>    <font color="red">"Dia_Num"</font>,DAY([Date]),<br></br>    <font color="red">"DiadaSemanNum"</font>,WEEKDAY([Date],1),<br></br>    <font color="red">"Dia da Semana"</font>,FORMAT([Date],<font color="red">"ddd"</font>),<br></br>    <font color="red">"Dia"</font>, CONCATENATE(<font color="red">""</font>,DAY([Date])))<font color="green">//Coluna criada para ordenar os dias nos visuais de período</font>
<br></br><br></br>----------------------<br></br>Parâmetro - TOP N-5259851b-05da-44da-8072-da5955c7c63f<br></br><br></br>GENERATESERIES(1, 10, 1)<br></br><br></br><br></br>----------------------<br></br>Parâmetro - DT VALIDADE-4972f8b6-abe8-446a-9e5e-8f2537b54506<br></br><br></br>{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]), 0,<font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]), 1,<font color="red">"Trimestre"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]), 2,<font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>, NAMEOF('dCalendario'[Dia]), 3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]), 4,<font color="red">"Dia da Semana"</font>)<br></br>}<br></br><br></br><br></br>----------------------<br></br></font></div><br></br><hr></hr><br></br><h3><div>Partitions:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >QueryDefinition</td></tr><tr ><td >Mapa de Entrada-1602f76c-4c87-4689-ac43-92e1cca53c2a</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">AmazonRedshift.Database</font>("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com<font color="red">","</font>farmaxcluster"),<br></br>    qlt = Fonte{[Name=<font color="red">"qlt"</font>]}[Data],<br></br>    dim_product_input_map1 = qlt{[Name=<font color="red">"dim_product_input_map"</font>]}[Data],<br></br>    #<font color="red">"Linhas Filtradas"</font> = <font color="purple">Table.SelectRows</font>(dim_product_input_map1, each ([product_input_map_nm_center] = <font color="red">"FARM"</font>)),<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Linhas Filtradas"</font>,{{<font color="red">"product_input_map_nm_center"</font>, <font color="red">"CENTRO"</font>},{<font color="red">"product_input_map_cd_product"</font>, <font color="red">"COD MATERIAL"</font>}, {<font color="red">"product_input_map_dc_product"</font>, <font color="red">"DESC MATERIAL"</font>}, {<font color="red">"product_input_map_dc_unity"</font>, <font color="red">"UN"</font>}, {<font color="red">"product_input_map_cd_reference"</font>, <font color="red">"NF"</font>}, {<font color="red">"product_input_map_dt_launch_date"</font>, <font color="red">"DT LANÇAMENTO"</font>}, {<font color="red">"product_input_map_cd_provider"</font>, <font color="red">"COD FORNECEDOR"</font>}, {<font color="red">"product_input_map_nm_provider"</font>, <font color="red">"FORNECEDOR"</font>}, {<font color="red">"product_input_map_dt_production_date"</font>, <font color="red">"DT PRODUÇÃO"</font>}, {<font color="red">"product_input_map_cd_batch"</font>, <font color="red">"LOTE"</font>}, {<font color="red">"product_input_map_dt_due_date"</font>, <font color="red">"DT VENCIMENTO"</font>}, {<font color="red">"product_input_map_tp_material"</font>, <font color="red">"TIPO MATERIAL"</font>}, {<font color="red">"product_input_map_qt_product"</font>, <font color="red">"QTD"</font>}}),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Colunas Renomeadas"</font>,{{<font color="red">"COD MATERIAL"</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Tipo Alterado"</font></td></tr><tr ><td >Última Atualização-3dcf9b3e-a2e0-4ae6-b884-3662e2205a04</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">DateTimeZone.SwitchZone</font>(<font color="purple">DateTimeZone.LocalNow</font>(),-4,0)<br></br><font color="blue">in</font><br></br>    Fonte</td></tr><tr ><td >_Medidas-3e8375a7-9015-43a4-8dbb-d1660fa0dd98</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i44FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Coluna 1"</font> = _t]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Coluna 1"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Tipo Alterado"</font>,{<font color="red">"Coluna 1"</font>})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Removidas"</font></td></tr><tr ><td >dCalendario-ee8a98c6-efae-4060-9ab5-9fcf3ba08f48</td><td >ADDCOLUMNS(<br></br>   CALENDARAUTO(),<br></br>    <font color="red">"Ano"</font>,YEAR([Date]),<br></br>    <font color="red">"TrimNum"</font>,QUARTER([Date]),<br></br>    <font color="red">"Trim"</font>,CONCATENATE("Trim-",QUARTER([Date])),<br></br>    <font color="red">"MesNum"</font>,MONTH([Date]),<br></br>    <font color="red">"Mês"</font>,FORMAT([Date],<font color="red">"mmm"</font>),<br></br>    <font color="red">"Dia_Num"</font>,DAY([Date]),<br></br>    <font color="red">"DiadaSemanNum"</font>,WEEKDAY([Date],1),<br></br>    <font color="red">"Dia da Semana"</font>,FORMAT([Date],<font color="red">"ddd"</font>),<br></br>    <font color="red">"Dia"</font>, CONCATENATE(<font color="red">""</font>,DAY([Date])))<font color="green">//Coluna criada para ordenar os dias nos visuais de período</font></td></tr><tr ><td >Parâmetro - TOP N-5259851b-05da-44da-8072-da5955c7c63f</td><td >GENERATESERIES(1, 10, 1)</td></tr><tr ><td >Parâmetro - DT VALIDADE-4972f8b6-abe8-446a-9e5e-8f2537b54506</td><td >{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]), 0,<font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]), 1,<font color="red">"Trimestre"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]), 2,<font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>, NAMEOF('dCalendario'[Dia]), 3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]), 4,<font color="red">"Dia da Semana"</font>)<br></br>}</td></tr></table><script>
	var toggler = document.getElementsByClassName("caret");
	for (var i = 0; i < toggler.length; i++){
		toggler[i].addEventListener("click", function() {
			this.parentElement.querySelector(".nested").classList.toggle("active");
		});
	}
		
	var togglerAll = document.getElementsByClassName("dropDownCaret");
	for (var j=0; j<togglerAll.length; j++){
		togglerAll[j].addEventListener("click", function(event){
			if (event.currentTarget != event.target) return;
			if(this.parentElement.querySelector(".nested").classList.contains("active")){
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(currentValue.classList.contains("active")){
						currentValue.classList.remove("active");
					}
				});
			}
			else{
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(!currentValue.classList.contains("active")){
						currentValue.classList.add("active");
					}
				});
			}
		});
	}
</script></body></html>