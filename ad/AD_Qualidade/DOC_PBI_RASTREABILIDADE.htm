<html><style>body {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
h1, h2, h3, h4, h5, h6 {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
table, pre {
color: #000000;
background-color: #FFFFFF;
font-size: 16;
font-family: Serif;
font-weight: normal;
font-style: normal;
}

ul, #myUL {
  list-style-type: none;
}

#myUL {
  margin: 0;
  padding: 0;
}

.caret, .dropDownCaret {
  cursor: pointer;
}

.caret::before {
	content: "\25B6";
	color: black;
	display: inline - block;
	margin - right: 6px;
}

.dropDownCaret::before {
	content: "\25BC";
	color: black;
	display: inline - block;
	margin - right: 6px;
	float: right;
}


.nested {
  display: none;
}

.active {
  display: block;
}
</style><body><br></br><h1><div>Power BI Documentation</div></h1><br></br><hr></hr><h2><div>Generated by <a href="http://radacad.com/power-bi-helper">Power BI Helper</a> (Copyright &copy; <a href="http://radacad.com">RADACAD</a>).</div><br></br><div>Date: 03/02/2023 15:30:04</div><br></br></h2><h1><div>------------------******   Visualization    ******---------------------</div></h1><br></br><h2><div>File: RASTREABILIDADE.pbix</div></h2><br></br><h3><div>Path: G:\Meu Drive\DATAMAX\PBIXs\Qualidade\APP2\RASTREABILIDADE.pbix</div></h2><br></br><h1><div>------------------******   Model    ******---------------------</div></h1><br></br><h2><div>Model: RASTREABILIDADE</div></h2><br></br><hr></hr><br></br><h3><div>List of Tables:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >Description</td><td >Storage Mode</td><td >Source</td><td >Is Hidden</td></tr><tr ><td >RASTREABILIDADE</td><td ></td><td >Import</td><td ><pre>let
    Fonte = AmazonRedshift.Database("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com","farmaxcluster"),
    qlt = Fonte{[Name="qlt"]}[Data],
    dim_traceability_materials1 = qlt{[Name="dim_traceability_materials"]}[Data],
    #"Linhas Filtradas" = Table.SelectRows(dim_traceability_materials1, each ([traceability_materials_center] = "FARM")),
    #"Tipo Alterado" = Table.TransformColumnTypes(#"Linhas Filtradas",{{"traceability_materials_cod_material", type text}}),
    #"Colunas Renomeadas" = Table.RenameColumns(#"Tipo Alterado",{{"traceability_materials_doc_material", "DOC MATERIAL"},{"traceability_materials_dt_mov","DT MOV"},
{"traceability_materials_cod_material","COD MATERIAL"},
{"traceability_materials_tipo_produto","TIPO"},
{"traceability_materials_desc_material","DESC MATERIAL"}, 
{"traceability_materials_lote","LOTE"}, 
{"traceability_materials_qtd_mov","QTD MOV"}, 
{"traceability_materials_dt_validade_insumos","DT VALIDADE INSUMOS"}, 
{"traceability_materials_dias_fim_validade_insumo","DIAS FIM VALIDADE INSUMO"}, 
{"traceability_materials_status_validade_insumos","STATUS VALIDADE INSUMO"}, 
{"traceability_materials_ordem_pi_pa","ORDEM PI PA"}, 
{"traceability_materials_cod_produto_ofu","COD PRODUTO OFU"},
{"traceability_materials_produto_ofu","PRODUTO OFU"},
{"traceability_materials_lote_pi_pa","LOTE PI-PA"},
{"traceability_materials_dt_validade_pi_pa","DT VALIDADE PI-PA"},
{"traceability_materials_dias_fim_validade_pi_pa","DIAS FIM VALIDADE PI-PA"},
{"traceability_materials_status_validade_pi_pa","STATUS VALIDADE PI-PA"},
{"traceability_materials_um","UN"},
{"traceability_materials_center","CENTRO"}}),
    #"Texto Aparado" = Table.TransformColumns(#"Colunas Renomeadas",{{"LOTE", Text.Trim, type text}})
in
    #"Texto Aparado"</pre></td><td >False</td></tr><tr ><td >_Medidas</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText("i44FAA==", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#"Coluna 1" = _t]),
    #"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Coluna 1", type text}}),
    #"Colunas Removidas" = Table.RemoveColumns(#"Tipo Alterado",{"Coluna 1"})
in
    #"Colunas Removidas"</pre></td><td >False</td></tr><tr ><td >dCalendario</td><td ></td><td >Import</td><td ><pre>ADDCOLUMNS(
   CALENDARAUTO(),
    "Ano",YEAR([Date]),
    "TrimNum",QUARTER([Date]),
    "Trim",CONCATENATE("Trim-",QUARTER([Date])),
    "MesNum",MONTH([Date]),
    "Mês",FORMAT([Date],"mmm"),
    "Dia_Num",DAY([Date]),
    "DiadaSemanNum",WEEKDAY([Date],1),
    "Dia da Semana",FORMAT([Date],"ddd"),
    "Dia", CONCATENATE("",DAY([Date])))//Coluna criada para ordenar os dias nos visuais de período</pre></td><td >False</td></tr><tr ><td >Parâmetro - Data</td><td ></td><td >Import</td><td ><pre>{
    ("Ano", NAMEOF('dCalendario'[Ano]),0, "Ano"),
    ("Trim", NAMEOF('dCalendario'[Trim]),1,"Trim"),
    ("Mês", NAMEOF('dCalendario'[Mês]),2, "Mês"),
    ("Dia", NAMEOF('dCalendario'[Dia]),3,"Dia"),
    ("Dia da Semana", NAMEOF('dCalendario'[Dia da Semana]),4, "Dia da Semana")
}</pre></td><td >False</td></tr><tr ><td >Parâmetro - DT Vencimento</td><td ></td><td >Import</td><td ><pre>{
    ("Ano", NAMEOF('dCalendario'[Ano]), 0,"Ano"),
    ("Trim", NAMEOF('dCalendario'[Trim]), 1,"Trim"),
    ("Mês", NAMEOF('dCalendario'[Mês]), 2,"Mês"),
    ("Dia", NAMEOF('dCalendario'[Dia]), 3,"Dia"),
    ("Dia da Semana", NAMEOF('dCalendario'[Dia da Semana]), 4," Dia da Semana")
}</pre></td><td >False</td></tr><tr ><td >Última Atualização</td><td ></td><td >Import</td><td ><pre>let
    Fonte = DateTimeZone.SwitchZone(DateTimeZone.LocalNow(),-4,0)
in
    Fonte</pre></td><td >False</td></tr></table><hr></hr><br></br><h3><div>List of Measures:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Measure Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
		<th>Dependency</th>
		<th>Reverse Dependency</th>
	</tr>
	<tr>
		<td>01_Total Mov.</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>COUNT ( 'RASTREABILIDADE'[COD MATERIAL] ) + 0
//Quantidade de vezes que um insumo foi utilizado</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 01_Total Mov.</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: COD MATERIAL (Table: RASTREABILIDADE)</li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 01_Total Mov.</span><span class="dropDownCaret">
<ul class="nested">
<li>Measure: 02_Embalagem Mov.</li>
<li>Measure: 03_Insumo Mov.</li>
<li>Measure: 04_Semiacabdo Mov.</li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>02_Embalagem Mov.</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total Mov.],
    'Rastreabilidade'[TIPO] = "EMBALAGEM"
) + 0
//  total de movimentações de embalagens</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 02_Embalagem Mov.</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: TIPO (Table: RASTREABILIDADE)</li>
<li><span class="caret">Measure: 01_Total Mov. (Table: _Medidas)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: COD MATERIAL (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 02_Embalagem Mov.</td>
	</tr>
	<tr>
		<td>03_Insumo Mov.</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total Mov.],
    'Rastreabilidade'[TIPO] = "INSUMO"
) + 0
//  total de movimentações de insumos</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 03_Insumo Mov.</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: TIPO (Table: RASTREABILIDADE)</li>
<li><span class="caret">Measure: 01_Total Mov. (Table: _Medidas)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: COD MATERIAL (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 03_Insumo Mov.</td>
	</tr>
	<tr>
		<td>04_Semiacabdo Mov.</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total Mov.],
    'Rastreabilidade'[TIPO] = "SEMIACABADO"
) + 0
//  total de movimentações de SEMIACABADOS</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 04_Semiacabdo Mov.</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: TIPO (Table: RASTREABILIDADE)</li>
<li><span class="caret">Measure: 01_Total Mov. (Table: _Medidas)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: COD MATERIAL (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 04_Semiacabdo Mov.</td>
	</tr>
	<tr>
		<td>05_Mat Produzido</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( RASTREABILIDADE[CC_MATERIAL PRODUZIDO] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 05_Mat Produzido</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li><span class="caret">Calc_Column: CC_MATERIAL PRODUZIDO (Table: RASTREABILIDADE)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE   ...</li>
<li>Column: COD PRODUTO OFU (Table: RASTREABILIDADE)</li>
<li>Column: LOTE PI-PA (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 05_Mat Produzido</td>
	</tr>
	<tr>
		<td>06_Total de Lotes Pi-Pa Distinto</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( 'Rastreabilidade'[LOTE PI-PA] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 06_Total de Lotes Pi-Pa Distinto</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: LOTE PI-PA (Table: RASTREABILIDADE)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 06_Total de Lotes Pi-Pa Distinto</td>
	</tr>
	<tr>
		<td>07_Validade Materiais</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( RASTREABILIDADE[CC_VALIDADE MATERIAL] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 07_Validade Materiais</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li><span class="caret">Calc_Column: CC_VALIDADE MATERIAL (Table: RASTREABILIDADE)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE   ...</li>
<li>Column: COD MATERIAL (Table: RASTREABILIDADE)</li>
<li>Column: LOTE (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE INSUMOS (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 07_Validade Materiais</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: 09_Materiais a Vencer</span>
<ul class="nested">
<li>Measure: 11_Destacar Maior Valor Vencimentos Insumos</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>08_Validade Lote Pi-Pa</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( RASTREABILIDADE[CC_ VALIDADE LOTE PI - PA] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 08_Validade Lote Pi-Pa</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li><span class="caret">Calc_Column: CC_ VALIDADE LOTE PI - PA (Table: RASTREABILIDADE)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE   ...</li>
<li>Column: COD PRODUTO OFU (Table: RASTREABILIDADE)</li>
<li>Column: LOTE PI-PA (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE PI-PA (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 08_Validade Lote Pi-Pa</span><span class="dropDownCaret">
<ul class="nested">
<li>Measure: 10_Lote Pi-Pa a Vencer</li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>09_Materiais a Vencer</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [07_Validade Materiais],
    RASTREABILIDADE[STATUS VALIDADE INSUMO] = "VALIDO"
) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 09_Materiais a Vencer</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: STATUS VALIDADE INSUMO (Table: RASTREABILIDADE)</li>
<li><span class="caret">Measure: 07_Validade Materiais (Table: _Medidas)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li><span class="caret">Calc_Column: CC_VALIDADE MATERIAL (Table: RASTREABILIDADE)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE   ...</li>
<li>Column: COD MATERIAL (Table: RASTREABILIDADE)</li>
<li>Column: LOTE (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE INSUMOS (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 09_Materiais a Vencer</span><span class="dropDownCaret">
<ul class="nested">
<li>Measure: 11_Destacar Maior Valor Vencimentos Insumos</li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>10_Lote Pi-Pa a Vencer</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [08_Validade Lote Pi-Pa],
    RASTREABILIDADE[STATUS VALIDADE PI-PA] = "VALIDO",
    USERELATIONSHIP ( dCalendario[Date], RASTREABILIDADE[DT VALIDADE PI-PA] )
) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 10_Lote Pi-Pa a Vencer</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: DT VALIDADE PI-PA (Table: RASTREABILIDADE)</li>
<li>Column: STATUS VALIDADE PI-PA (Table: RASTREABILIDADE)</li>
<li><span class="caret">Measure: 08_Validade Lote Pi-Pa (Table: _Medidas)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li><span class="caret">Calc_Column: CC_ VALIDADE LOTE PI - PA (Table: RASTREABILIDADE)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE   ...</li>
<li>Column: COD PRODUTO OFU (Table: RASTREABILIDADE)</li>
<li>Column: LOTE PI-PA (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE PI-PA (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario (Table: dCalendario)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: DT MOV (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE INSUMOS (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE PI-PA (Table: RASTREABILIDADE)</li>
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li>Calc_Column: Date (Table: dCalendario)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 10_Lote Pi-Pa a Vencer</td>
	</tr>
	<tr>
		<td>11_Destacar Maior Valor Vencimentos Insumos</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>VAR COR_DESTAQUE = "#094780"
VAR COR_PADRAO = "#CCD5EB"
VAR VMAIORANO =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Ano] ),
            [09_Materiais a Vencer]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORTRI =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Trim] ),
            [09_Materiais a Vencer]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORMES =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Mês] ),
            [09_Materiais a Vencer]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORDIA =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Dia] ),
            [09_Materiais a Vencer]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORDIADASEMANA =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Dia da Semana] ),
            [09_Materiais a Vencer]
        ),
        ALLSELECTED ( dCalendario )
    )
RETURN
    SWITCH (
        TRUE (),
        ISINSCOPE ( dCalendario[Dia] )
            && [09_Materiais a Vencer] = VMAIORDIA, COR_DESTAQUE,
        [09_Materiais a Vencer] = VMAIORANO, COR_DESTAQUE,
        [09_Materiais a Vencer] = VMAIORMES, COR_DESTAQUE,
        [09_Materiais a Vencer] = VMAIORTRI, COR_DESTAQUE,
        [09_Materiais a Vencer] = VMAIORDIADASEMANA, COR_DESTAQUE,
        COR_PADRAO
    )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 11_Destacar Maior Valor Vencimentos Insumos</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario (Table: dCalendario)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: DT MOV (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE INSUMOS (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE PI-PA (Table: RASTREABILIDADE)</li>
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li>Calc_Column: Ano (Table: dCalendario)</li>
<li><span class="caret">Calc_Column: Trim (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: TrimNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: Dia_Num (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia da Semana (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: DiadaSemanNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Measure: 09_Materiais a Vencer (Table: _Medidas)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: STATUS VALIDADE INSUMO (Table: RASTREABILIDADE)</li>
<li><span class="caret">Measure: 07_Validade Materiais (Table: _Medidas)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li><span class="caret">Calc_Column: CC_VALIDADE MATERIAL (Table: RASTREABILIDADE)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE   ...</li>
<li>Column: COD MATERIAL (Table: RASTREABILIDADE)</li>
<li>Column: LOTE (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE INSUMOS (Table: RASTREABILIDADE)</li>
</ul></li>
</ul></li>
</ul></li>
<li><span class="caret">Calc_Column: Mês (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: MesNum (Table: dCalendario)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 11_Destacar Maior Valor Vencimentos Insumos</td>
	</tr>
	<tr>
		<td>T&#237;tulo 1 Total de Materiais por Per&#237;odo de Vencimento</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Total de Materiais por Período de Vencimento "
    & SELECTEDVALUE ( 'Parâmetro - Data'[Value4] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Título 1 Total de Materiais por Período de Vencimento</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - Data (Table: Parâmetro - Data)</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario (Table: dCalendario)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: DT MOV (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE INSUMOS (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE PI-PA (Table: RASTREABILIDADE)</li>
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li>Calc_Column: Ano (Table: dCalendario)</li>
<li><span class="caret">Calc_Column: Trim (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: TrimNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: Dia_Num (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia da Semana (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: DiadaSemanNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Mês (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: MesNum (Table: dCalendario)</li>
</ul></li>
<li>Attribute_Hierarchy: Parâmetro - Data Pedido (Table: Parâmetro - Data)</li>
</ul></li>
<li>Calc_Column: Value4 (Table: Parâmetro - Data)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Título 1 Total de Materiais por Período de Vencimento</td>
	</tr>
	<tr>
		<td>T&#237;tulo 2 Total de Lotes Pi - Pa por Per&#237;odo de Vencimento</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Total de Lotes Pi - Pa por Período de Vencimento "
    & SELECTEDVALUE ( 'Parâmetro - Data'[Value4] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Título 2 Total de Lotes Pi - Pa por Período de Vencimento</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro - Data (Table: Parâmetro - Data)</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario (Table: dCalendario)</span>
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: DT MOV (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE INSUMOS (Table: RASTREABILIDADE)</li>
<li>Column: DT VALIDADE PI-PA (Table: RASTREABILIDADE)</li>
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li>Calc_Column: Ano (Table: dCalendario)</li>
<li><span class="caret">Calc_Column: Trim (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: TrimNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: Dia_Num (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia da Semana (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: DiadaSemanNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Mês (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: MesNum (Table: dCalendario)</li>
</ul></li>
<li>Attribute_Hierarchy: Parâmetro - Data Pedido (Table: Parâmetro - Data)</li>
</ul></li>
<li>Calc_Column: Value4 (Table: Parâmetro - Data)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Título 2 Total de Lotes Pi - Pa por Período de Vencimento</td>
	</tr>
	<tr>
		<td>12_Data/Hora</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>NOW () - 3 / 24</pre></td>
		<td>Measure: 12_Data/Hora</td>
		<td>Measure: 12_Data/Hora</td>
	</tr>
	<tr>
		<td>13_Usu&#225;rio</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>USERPRINCIPALNAME ()</pre></td>
		<td>Measure: 13_Usuário</td>
		<td>Measure: 13_Usuário</td>
	</tr>
	<tr>
		<td>Per&#237;odo data de Movi</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Período de movimentação: "
    & MIN ( RASTREABILIDADE[DT MOV] ) & " - "
    & MAX ( RASTREABILIDADE[DT MOV] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Período data de Movi</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: RASTREABILIDADE</li>
<li>Column: DT MOV (Table: RASTREABILIDADE)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Período data de Movi</td>
	</tr>
	<tr>
		<td>&#218;ltima atualiza&#231;&#227;o</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Última atualização agendada: "
    & SELECTEDVALUE ( 'Última Atualização'[Última Atualização] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Última atualização</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Última atualização</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Measure: 10_Lote Pi-Pa a Vencer</li>
<li><span class="caret">Calc_Table: Parâmetro - Data</span>
<ul class="nested">
<li>Measure: Título 1 Total de Materiais por Período de Vencimento</li>
<li>Measure: Título 2 Total de Lotes Pi - Pa por Período de Vencimento</li>
</ul></li>
<li>Measure: 11_Destacar Maior Valor Vencimentos Insumos</li>
<li>Calc_Table: Parâmetro - DT Vencimento</li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Measure: 10_Lote Pi-Pa a Vencer</li>
<li><span class="caret">Calc_Table: Parâmetro - Data</span>
<ul class="nested">
<li>Measure: Título 1 Total de Materiais por Período de Vencimento</li>
<li>Measure: Título 2 Total de Lotes Pi - Pa por Período de Vencimento</li>
</ul></li>
<li>Measure: 11_Destacar Maior Valor Vencimentos Insumos</li>
<li>Calc_Table: Parâmetro - DT Vencimento</li>
</ul></li>
<li><span class="caret">Measure: Última atualização</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Measure: 10_Lote Pi-Pa a Vencer</li>
<li><span class="caret">Calc_Table: Parâmetro - Data</span>
<ul class="nested">
<li>Measure: Título 1 Total de Materiais por Período de Vencimento</li>
<li>Measure: Título 2 Total de Lotes Pi - Pa por Período de Vencimento</li>
</ul></li>
<li>Measure: 11_Destacar Maior Valor Vencimentos Insumos</li>
<li>Calc_Table: Parâmetro - DT Vencimento</li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Measure: 10_Lote Pi-Pa a Vencer</li>
<li><span class="caret">Calc_Table: Parâmetro - Data</span>
<ul class="nested">
<li>Measure: Título 1 Total de Materiais por Período de Vencimento</li>
<li>Measure: Título 2 Total de Lotes Pi - Pa por Período de Vencimento</li>
</ul></li>
<li>Measure: 11_Destacar Maior Valor Vencimentos Insumos</li>
<li>Calc_Table: Parâmetro - DT Vencimento</li>
</ul></li>
<li>Measure: Última atualização ...</li>
<li>Measure: Última atualização ...</li>
</ul></li>
<li><span class="caret">Measure: Última atualização</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Measure: 10_Lote Pi-Pa a Vencer</li>
<li><span class="caret">Calc_Table: Parâmetro - Data</span>
<ul class="nested">
<li>Measure: Título 1 Total de Materiais por Período de Vencimento</li>
<li>Measure: Título 2 Total de Lotes Pi - Pa por Período de Vencimento</li>
</ul></li>
<li>Measure: 11_Destacar Maior Valor Vencimentos Insumos</li>
<li>Calc_Table: Parâmetro - DT Vencimento</li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Measure: 10_Lote Pi-Pa a Vencer</li>
<li><span class="caret">Calc_Table: Parâmetro - Data</span>
<ul class="nested">
<li>Measure: Título 1 Total de Materiais por Período de Vencimento</li>
<li>Measure: Título 2 Total de Lotes Pi - Pa por Período de Vencimento</li>
</ul></li>
<li>Measure: 11_Destacar Maior Valor Vencimentos Insumos</li>
<li>Calc_Table: Parâmetro - DT Vencimento</li>
</ul></li>
<li>Measure: Última atualização ...</li>
<li>Measure: Última atualização ...</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table RASTREABILIDADE:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>DOC MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DT MOV</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>COD MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TIPO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DESC MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>LOTE</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>QTD MOV</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DT VALIDADE INSUMOS</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DIAS FIM VALIDADE INSUMO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>STATUS VALIDADE INSUMO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ORDEM PI PA</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>COD PRODUTO OFU</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>PRODUTO OFU</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>LOTE PI-PA</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DT VALIDADE PI-PA</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DIAS FIM VALIDADE PI-PA</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>STATUS VALIDADE PI-PA</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>UN</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CENTRO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CC_VALIDADE MATERIAL</td>
		<td></td>
		<td>Calculated Column</td>
		<td>&#39;Rastreabilidade&#39;[COD MATERIAL]&amp;&#39;Rastreabilidade&#39;[LOTE]&amp;&#39;Rastreabilidade&#39;[DT VALIDADE INSUMOS]
//Coluna Criada para realizar a contagem distinta da validade dos insumo, pois o mesmo material tem validades dferentes</td>
	</tr>
	<tr>
		<td>CC_ VALIDADE LOTE PI - PA</td>
		<td></td>
		<td>Calculated Column</td>
		<td>&#39;Rastreabilidade&#39;[COD PRODUTO OFU] &amp; &#39;Rastreabilidade&#39;[LOTE PI-PA] &amp; &#39;Rastreabilidade&#39;[DT VALIDADE PI-PA] // Coluna Criada para realizar a contagem distinta da validade dos lotes de Pi-Pa, pois o mesmo lote tem validades dferentes</td>
	</tr>
	<tr>
		<td>CC_MATERIAL PRODUZIDO</td>
		<td></td>
		<td>Calculated Column</td>
		<td>&#39;Rastreabilidade&#39;[COD PRODUTO OFU] &amp; &#39;Rastreabilidade&#39;[LOTE PI-PA] // CC criada para contar quantidade de materiais produzidos, pois o mesmo cod de material term mais de um lote de produ&#231;&#227;o</td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table _Medidas:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table dCalendario:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Date</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Ano</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TrimNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Trim</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>MesNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DiadaSemanNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia da Semana</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>M&#234;s</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia_Num</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Parâmetro - Data:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Par&#226;metro - Data</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Value4</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Parâmetro - DT Vencimento:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Par&#226;metro - DT Vencimento</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Value4</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Última Atualização:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>&#218;ltima Atualiza&#231;&#227;o</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Roles:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Role Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>Relationships:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >CrossFilteringBehavior</td><td >FromCardinality</td><td >FromColumn</td><td >FromTable</td><td >IsActive</td><td >IsRemoved</td><td >JoinOnDateBehavior</td><td >RelyOnReferentialIntegrity</td><td >SecurityFilteringBehavior</td><td >State</td><td >ToCardinality</td><td >ToColumn</td><td >ToTable</td><td >Type</td></tr><tr ><td >17d70e26-95a6-4616-91ec-c07177f60340</td><td >OneDirection</td><td >Many</td><td >DT VALIDADE INSUMOS</td><td >RASTREABILIDADE</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Date</td><td >dCalendario</td><td >SingleColumn</td></tr><tr ><td >b25e85e5-29ae-4134-8f79-334e7b0aa077</td><td >OneDirection</td><td >Many</td><td >DT VALIDADE PI-PA</td><td >RASTREABILIDADE</td><td >False</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Date</td><td >dCalendario</td><td >SingleColumn</td></tr></table><hr></hr><br></br><h2><div>M (Power Query) Script:</div></h2><br></br><br></br><font face="verdana" size="2"<div>RASTREABILIDADE-b83c97a1-2d30-4302-9fbb-aab7886d6b07<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">AmazonRedshift.Database</font>("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com<font color="red">","</font>farmaxcluster"),<br></br>    qlt = Fonte{[Name=<font color="red">"qlt"</font>]}[Data],<br></br>    dim_traceability_materials1 = qlt{[Name=<font color="red">"dim_traceability_materials"</font>]}[Data],<br></br>    #<font color="red">"Linhas Filtradas"</font> = <font color="purple">Table.SelectRows</font>(dim_traceability_materials1, each ([traceability_materials_center] = <font color="red">"FARM"</font>)),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Linhas Filtradas"</font>,{{<font color="red">"traceability_materials_cod_material"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Tipo Alterado"</font>,{{<font color="red">"traceability_materials_doc_material"</font>, <font color="red">"DOC MATERIAL"</font>},{<font color="red">"traceability_materials_dt_mov"</font>,<font color="red">"DT MOV"</font>},<br></br>{<font color="red">"traceability_materials_cod_material"</font>,<font color="red">"COD MATERIAL"</font>},<br></br>{<font color="red">"traceability_materials_tipo_produto"</font>,<font color="red">"TIPO"</font>},<br></br>{<font color="red">"traceability_materials_desc_material"</font>,<font color="red">"DESC MATERIAL"</font>}, <br></br>{<font color="red">"traceability_materials_lote"</font>,<font color="red">"LOTE"</font>}, <br></br>{<font color="red">"traceability_materials_qtd_mov"</font>,<font color="red">"QTD MOV"</font>}, <br></br>{<font color="red">"traceability_materials_dt_validade_insumos"</font>,<font color="red">"DT VALIDADE INSUMOS"</font>}, <br></br>{<font color="red">"traceability_materials_dias_fim_validade_insumo"</font>,<font color="red">"DIAS FIM VALIDADE INSUMO"</font>}, <br></br>{<font color="red">"traceability_materials_status_validade_insumos"</font>,<font color="red">"STATUS VALIDADE INSUMO"</font>}, <br></br>{<font color="red">"traceability_materials_ordem_pi_pa"</font>,<font color="red">"ORDEM PI PA"</font>}, <br></br>{<font color="red">"traceability_materials_cod_produto_ofu"</font>,<font color="red">"COD PRODUTO OFU"</font>},<br></br>{<font color="red">"traceability_materials_produto_ofu"</font>,<font color="red">"PRODUTO OFU"</font>},<br></br>{<font color="red">"traceability_materials_lote_pi_pa"</font>,"LOTE PI-PA"},<br></br>{<font color="red">"traceability_materials_dt_validade_pi_pa"</font>,"DT VALIDADE PI-PA"},<br></br>{<font color="red">"traceability_materials_dias_fim_validade_pi_pa"</font>,"DIAS FIM VALIDADE PI-PA"},<br></br>{<font color="red">"traceability_materials_status_validade_pi_pa"</font>,"STATUS VALIDADE PI-PA"},<br></br>{<font color="red">"traceability_materials_um"</font>,<font color="red">"UN"</font>},<br></br>{<font color="red">"traceability_materials_center"</font>,<font color="red">"CENTRO"</font>}}),<br></br>    #<font color="red">"Texto Aparado"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Colunas Renomeadas"</font>,{{<font color="red">"LOTE"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Texto Aparado"</font><br></br><br></br><br></br>----------------------<br></br>_Medidas-16eebd78-ccd2-4750-b68f-3c26b19e0e98<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i44FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Coluna 1"</font> = _t]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Coluna 1"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Tipo Alterado"</font>,{<font color="red">"Coluna 1"</font>})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Removidas"</font><br></br><br></br><br></br>----------------------<br></br>dCalendario-cadcc101-0d1d-4807-ae23-856ca47ffc59<br></br><br></br>ADDCOLUMNS(<br></br>   CALENDARAUTO(),<br></br>    <font color="red">"Ano"</font>,YEAR([Date]),<br></br>    <font color="red">"TrimNum"</font>,QUARTER([Date]),<br></br>    <font color="red">"Trim"</font>,CONCATENATE("Trim-",QUARTER([Date])),<br></br>    <font color="red">"MesNum"</font>,MONTH([Date]),<br></br>    <font color="red">"Mês"</font>,FORMAT([Date],<font color="red">"mmm"</font>),<br></br>    <font color="red">"Dia_Num"</font>,DAY([Date]),<br></br>    <font color="red">"DiadaSemanNum"</font>,WEEKDAY([Date],1),<br></br>    <font color="red">"Dia da Semana"</font>,FORMAT([Date],<font color="red">"ddd"</font>),<br></br>    <font color="red">"Dia"</font>, CONCATENATE(<font color="red">""</font>,DAY([Date])))<font color="green">//Coluna criada para ordenar os dias nos visuais de período</font>
<br></br><br></br>----------------------<br></br>Parâmetro - Data-b37858dd-1752-444a-bcff-c842fdaee8db<br></br><br></br>{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]),0, <font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]),1,<font color="red">"Trim"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]),2, <font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>, NAMEOF('dCalendario'[Dia]),3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]),4, <font color="red">"Dia da Semana"</font>)<br></br>}<br></br><br></br><br></br>----------------------<br></br>Parâmetro - DT Vencimento-31e97c20-2a66-4e2e-a8e5-bcc579b6c8f7<br></br><br></br>{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]), 0,<font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]), 1,<font color="red">"Trim"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]), 2,<font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>, NAMEOF('dCalendario'[Dia]), 3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]), 4,<font color="red">" Dia da Semana"</font>)<br></br>}<br></br><br></br><br></br>----------------------<br></br>Última Atualização-5157007d-9d72-4ff4-baa6-d95ad102cc8e<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">DateTimeZone.SwitchZone</font>(<font color="purple">DateTimeZone.LocalNow</font>(),-4,0)<br></br><font color="blue">in</font><br></br>    Fonte<br></br><br></br><br></br>----------------------<br></br></font></div><br></br><hr></hr><br></br><h3><div>Partitions:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >QueryDefinition</td></tr><tr ><td >RASTREABILIDADE-b83c97a1-2d30-4302-9fbb-aab7886d6b07</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">AmazonRedshift.Database</font>("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com<font color="red">","</font>farmaxcluster"),<br></br>    qlt = Fonte{[Name=<font color="red">"qlt"</font>]}[Data],<br></br>    dim_traceability_materials1 = qlt{[Name=<font color="red">"dim_traceability_materials"</font>]}[Data],<br></br>    #<font color="red">"Linhas Filtradas"</font> = <font color="purple">Table.SelectRows</font>(dim_traceability_materials1, each ([traceability_materials_center] = <font color="red">"FARM"</font>)),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(#<font color="red">"Linhas Filtradas"</font>,{{<font color="red">"traceability_materials_cod_material"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(#<font color="red">"Tipo Alterado"</font>,{{<font color="red">"traceability_materials_doc_material"</font>, <font color="red">"DOC MATERIAL"</font>},{<font color="red">"traceability_materials_dt_mov"</font>,<font color="red">"DT MOV"</font>},<br></br>{<font color="red">"traceability_materials_cod_material"</font>,<font color="red">"COD MATERIAL"</font>},<br></br>{<font color="red">"traceability_materials_tipo_produto"</font>,<font color="red">"TIPO"</font>},<br></br>{<font color="red">"traceability_materials_desc_material"</font>,<font color="red">"DESC MATERIAL"</font>}, <br></br>{<font color="red">"traceability_materials_lote"</font>,<font color="red">"LOTE"</font>}, <br></br>{<font color="red">"traceability_materials_qtd_mov"</font>,<font color="red">"QTD MOV"</font>}, <br></br>{<font color="red">"traceability_materials_dt_validade_insumos"</font>,<font color="red">"DT VALIDADE INSUMOS"</font>}, <br></br>{<font color="red">"traceability_materials_dias_fim_validade_insumo"</font>,<font color="red">"DIAS FIM VALIDADE INSUMO"</font>}, <br></br>{<font color="red">"traceability_materials_status_validade_insumos"</font>,<font color="red">"STATUS VALIDADE INSUMO"</font>}, <br></br>{<font color="red">"traceability_materials_ordem_pi_pa"</font>,<font color="red">"ORDEM PI PA"</font>}, <br></br>{<font color="red">"traceability_materials_cod_produto_ofu"</font>,<font color="red">"COD PRODUTO OFU"</font>},<br></br>{<font color="red">"traceability_materials_produto_ofu"</font>,<font color="red">"PRODUTO OFU"</font>},<br></br>{<font color="red">"traceability_materials_lote_pi_pa"</font>,"LOTE PI-PA"},<br></br>{<font color="red">"traceability_materials_dt_validade_pi_pa"</font>,"DT VALIDADE PI-PA"},<br></br>{<font color="red">"traceability_materials_dias_fim_validade_pi_pa"</font>,"DIAS FIM VALIDADE PI-PA"},<br></br>{<font color="red">"traceability_materials_status_validade_pi_pa"</font>,"STATUS VALIDADE PI-PA"},<br></br>{<font color="red">"traceability_materials_um"</font>,<font color="red">"UN"</font>},<br></br>{<font color="red">"traceability_materials_center"</font>,<font color="red">"CENTRO"</font>}}),<br></br>    #<font color="red">"Texto Aparado"</font> = <font color="purple">Table.TransformColumns</font>(#<font color="red">"Colunas Renomeadas"</font>,{{<font color="red">"LOTE"</font>, <font color="purple">Text.Trim</font>, <font color="blue">type</font> <font color="blue">text</font>}})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Texto Aparado"</font></td></tr><tr ><td >_Medidas-16eebd78-ccd2-4750-b68f-3c26b19e0e98</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i44FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Coluna 1"</font> = _t]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Coluna 1"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Tipo Alterado"</font>,{<font color="red">"Coluna 1"</font>})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Removidas"</font></td></tr><tr ><td >dCalendario-cadcc101-0d1d-4807-ae23-856ca47ffc59</td><td >ADDCOLUMNS(<br></br>   CALENDARAUTO(),<br></br>    <font color="red">"Ano"</font>,YEAR([Date]),<br></br>    <font color="red">"TrimNum"</font>,QUARTER([Date]),<br></br>    <font color="red">"Trim"</font>,CONCATENATE("Trim-",QUARTER([Date])),<br></br>    <font color="red">"MesNum"</font>,MONTH([Date]),<br></br>    <font color="red">"Mês"</font>,FORMAT([Date],<font color="red">"mmm"</font>),<br></br>    <font color="red">"Dia_Num"</font>,DAY([Date]),<br></br>    <font color="red">"DiadaSemanNum"</font>,WEEKDAY([Date],1),<br></br>    <font color="red">"Dia da Semana"</font>,FORMAT([Date],<font color="red">"ddd"</font>),<br></br>    <font color="red">"Dia"</font>, CONCATENATE(<font color="red">""</font>,DAY([Date])))<font color="green">//Coluna criada para ordenar os dias nos visuais de período</font></td></tr><tr ><td >Parâmetro - Data-b37858dd-1752-444a-bcff-c842fdaee8db</td><td >{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]),0, <font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]),1,<font color="red">"Trim"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]),2, <font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>, NAMEOF('dCalendario'[Dia]),3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]),4, <font color="red">"Dia da Semana"</font>)<br></br>}</td></tr><tr ><td >Parâmetro - DT Vencimento-31e97c20-2a66-4e2e-a8e5-bcc579b6c8f7</td><td >{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]), 0,<font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]), 1,<font color="red">"Trim"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]), 2,<font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>, NAMEOF('dCalendario'[Dia]), 3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]), 4,<font color="red">" Dia da Semana"</font>)<br></br>}</td></tr><tr ><td >Última Atualização-5157007d-9d72-4ff4-baa6-d95ad102cc8e</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">DateTimeZone.SwitchZone</font>(<font color="purple">DateTimeZone.LocalNow</font>(),-4,0)<br></br><font color="blue">in</font><br></br>    Fonte</td></tr></table><script>
	var toggler = document.getElementsByClassName("caret");
	for (var i = 0; i < toggler.length; i++){
		toggler[i].addEventListener("click", function() {
			this.parentElement.querySelector(".nested").classList.toggle("active");
		});
	}
		
	var togglerAll = document.getElementsByClassName("dropDownCaret");
	for (var j=0; j<togglerAll.length; j++){
		togglerAll[j].addEventListener("click", function(event){
			if (event.currentTarget != event.target) return;
			if(this.parentElement.querySelector(".nested").classList.contains("active")){
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(currentValue.classList.contains("active")){
						currentValue.classList.remove("active");
					}
				});
			}
			else{
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(!currentValue.classList.contains("active")){
						currentValue.classList.add("active");
					}
				});
			}
		});
	}
</script></body></html>