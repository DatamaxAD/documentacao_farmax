<html><style>body {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
h1, h2, h3, h4, h5, h6 {
color: #000000;
background-color: #FFFFFF;
font-size: 24;
font-family: Serif;
font-weight: bold;
font-style: italic;
}
table, pre {
color: #000000;
background-color: #FFFFFF;
font-size: 16;
font-family: Serif;
font-weight: normal;
font-style: normal;
}

ul, #myUL {
  list-style-type: none;
}

#myUL {
  margin: 0;
  padding: 0;
}

.caret, .dropDownCaret {
  cursor: pointer;
}

.caret::before {
	content: "\25B6";
	color: black;
	display: inline - block;
	margin - right: 6px;
}

.dropDownCaret::before {
	content: "\25BC";
	color: black;
	display: inline - block;
	margin - right: 6px;
	float: right;
}


.nested {
  display: none;
}

.active {
  display: block;
}
</style><body><br></br><h1><div>Power BI Documentation</div></h1><br></br><hr></hr><h2><div>Generated by <a href="http://radacad.com/power-bi-helper">Power BI Helper</a> (Copyright &copy; <a href="http://radacad.com">RADACAD</a>).</div><br></br><div>Date: 03/02/2023 15:36:39</div><br></br></h2><h1><div>------------------******   Visualization    ******---------------------</div></h1><br></br><h2><div>File: DISTRIBUIÇÃO.pbix</div></h2><br></br><h3><div>Path: G:\Meu Drive\DATAMAX\PBIXs\Qualidade\APP2\DISTRIBUIÇÃO.pbix</div></h2><br></br><h1><div>------------------******   Model    ******---------------------</div></h1><br></br><h2><div>Model: DISTRIBUIÇÃO</div></h2><br></br><hr></hr><br></br><h3><div>List of Tables:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >Description</td><td >Storage Mode</td><td >Source</td><td >Is Hidden</td></tr><tr ><td >01_Mapa Distribuição</td><td ></td><td >Import</td><td ><pre>let
    Fonte = AmazonRedshift.Database("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com","farmaxcluster"),
    qlt = Fonte{[Name="qlt"]}[Data],
    dim_distribuition_map = qlt{[Name="dim_distribuition_map"]}[Data],
    #"Colunas Renomeadas" = Table.RenameColumns(dim_distribuition_map,{{"distribuition_map_cod_material", "COD MATERIAL"}, {"distribuition_map_material", "DESC MATERIAL"}, {"distribuition_map_tipo_produto", "TIPO"}, {"distribuition_map_dt_faturamento", "DT FATURAMENTO"}, {"distribuition_map_quantidade", "QTD"}, {"distribuition_map_umb", "UND"}, {"distribuition_map_lote", "LOTE"}, {"distribuition_map_cod_cliente", "COD CLIENTE"}, {"distribuition_map_cliente", "CLIENTE"}, {"distribuition_map_tel_contato", "TEL CONTATO"}, {"distribuition_map_cnpj_cliente", "CNPJ"}, {"distribuition_map_cidade_cliente", "CIDADE"}, {"distribuition_map_estado_cliente", "ESTADO"}, {"distribuition_map_nfenum", "NF"}, {"distribuition_map_nota_remessa", "NF REMESSA"}, {"distribuition_map_cod_tipo_movimento", "TIPO MOVIMENTO"}, {"distribuition_map_item", "ITEM"}, {"distribuition_map_doc_material", "DOC MATERIAL"}, {"distribuition_map_centro", "CENTRO"},{"distribuition_map_email","E-MAIL"}}),
    #"Linhas Filtradas" = Table.SelectRows(#"Colunas Renomeadas", each true)
in
    #"Linhas Filtradas"</pre></td><td >False</td></tr><tr ><td >_Medidas</td><td ></td><td >Import</td><td ><pre>let
    Fonte = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText("i44FAA==", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#"Coluna 1" = _t]),
    #"Tipo Alterado" = Table.TransformColumnTypes(Fonte,{{"Coluna 1", type text}}),
    #"Colunas Removidas" = Table.RemoveColumns(#"Tipo Alterado",{"Coluna 1"})
in
    #"Colunas Removidas"</pre></td><td >False</td></tr><tr ><td >TopnClientes</td><td ></td><td >Import</td><td ><pre>GENERATESERIES(1, 10, 1) </pre></td><td >False</td></tr><tr ><td >dCalendario</td><td ></td><td >Import</td><td ><pre>ADDCOLUMNS(
   CALENDARAUTO(),
    "Ano",YEAR([Date]),
    "TrimNum",QUARTER([Date]),
    "Trim",CONCATENATE("Trim-",QUARTER([Date])),
    "MesNum",MONTH([Date]),
    "Mês",FORMAT([Date],"mmm"),
    "Dia_Num",DAY([Date]),
    "DiadaSemanNum",WEEKDAY([Date],1),
    "Dia da Semana",FORMAT([Date],"ddd"),
    "Dia", CONCATENATE("",DAY([Date])))//Coluna criada para ordenar os dias nos visuais de período</pre></td><td >False</td></tr><tr ><td >Parametro Data Faturamento</td><td ></td><td >Import</td><td ><pre>{
    ("Ano", NAMEOF('dCalendario'[Ano]), 0,"Ano"),
    ("Trim", NAMEOF('dCalendario'[Trim]), 1,"Trim"),
    ("Mês", NAMEOF('dCalendario'[Mês]), 2,"Mês"),
    ("Dia",NAMEOF(dCalendario[Dia]),3,"Dia"),
    ("Dia da Semana", NAMEOF('dCalendario'[Dia da Semana]), 4,"Dia da Semana")
}</pre></td><td >False</td></tr><tr ><td >TopProdutos</td><td ></td><td >Import</td><td ><pre>GENERATESERIES(1, 10, 1)</pre></td><td >False</td></tr><tr ><td >Última Atualização</td><td ></td><td >Import</td><td ><pre>let
    Fonte = DateTimeZone.SwitchZone(DateTimeZone.LocalNow(),-4,0)
in
    Fonte</pre></td><td >False</td></tr><tr ><td >Parâmetro_Data</td><td ></td><td >Import</td><td ><pre>{
    ("Ano", NAMEOF('dCalendario'[Ano]), 0,"Ano"),
    ("Trim", NAMEOF('dCalendario'[Trim]), 1,"Trim"),
    ("Mês", NAMEOF('dCalendario'[Mês]), 2,"Mês"),
    ("Dia", NAMEOF('dCalendario'[Dia]), 3,"Dia"),
    ("Dia da Semana", NAMEOF('dCalendario'[Dia da Semana]), 4,"Dia da Semana")
}</pre></td><td >False</td></tr></table><hr></hr><br></br><h3><div>List of Measures:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Measure Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
		<th>Dependency</th>
		<th>Reverse Dependency</th>
	</tr>
	<tr>
		<td>02_Total Materiais Dist</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( '01_Mapa Distribuição'[COD MATERIAL] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 02_Total Materiais Dist</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 02_Total Materiais Dist</td>
	</tr>
	<tr>
		<td>01_Total de Distribui&#231;&#245;es</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>COUNT ( '01_Mapa Distribuição'[COD MATERIAL] ) + 0
// Contagem de linhas</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 01_Total de Distribuições</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 01_Total de Distribuições</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: 06_TopNClientes</span>
<ul class="nested">
<li>Measure: 09_Destacar Maior Cliente com Distribuição</li>
</ul></li>
<li><span class="caret">Measure: 07_TopNProdutos</span>
<ul class="nested">
<li>Measure: 10_Destacar Maior Material Distribuído</li>
</ul></li>
<li>Measure: 08_%T Distribuição</li>
<li>Measure: 11_Destacar Maior Data Distribuição</li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>05_Total Clientes</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( '01_Mapa Distribuição'[COD CLIENTE] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 05_Total Clientes</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD CLIENTE (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 05_Total Clientes</td>
	</tr>
	<tr>
		<td>03_Total Lotes Dist</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( '01_Mapa Distribuição'[LOTE] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 03_Total Lotes Dist</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: LOTE (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 03_Total Lotes Dist</td>
	</tr>
	<tr>
		<td>T&#237;tulo 2 - Top 10 Clientes</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"TOP "
    & SELECTEDVALUE ( 'TopnClientes'[Topn] ) & " Clientes com mais distribuições"</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Título 2 - Top 10 Clientes</span><span class="dropDownCaret">
<ul class="nested">
<li>Calc_Table: TopnClientes (Table: TopnClientes)</li>
<li>Calc_Column: Topn (Table: TopnClientes)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Título 2 - Top 10 Clientes</td>
	</tr>
	<tr>
		<td>06_TopNClientes</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total de Distribuições],
    KEEPFILTERS (
        TOPN (
            TopnClientes[Topn Valor],
            ALL ( '01_Mapa Distribuição'[CLIENTE] ),
            [01_Total de Distribuições]
        )
    )
) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 06_TopNClientes</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Measure: 01_Total de Distribuições (Table: _Medidas)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li>Calc_Table: TopnClientes (Table: TopnClientes)</li>
<li><span class="caret">Measure: Topn Valor (Table: TopnClientes)</span>
<ul class="nested">
<li>Calc_Table: TopnClientes (Table: TopnClientes)</li>
<li>Calc_Column: Topn (Table: TopnClientes)</li>
</ul></li>
<li>Column: CLIENTE (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 06_TopNClientes</span><span class="dropDownCaret">
<ul class="nested">
<li>Measure: 09_Destacar Maior Cliente com Distribuição</li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>T&#237;tulo  - Data Fatutamento</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Total de Distribuição por Período de Faturamento "
    & SELECTEDVALUE (
        'Parâmetro_Data'[Value4],
        "Ano"
    )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Título  - Data Fatutamento</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Calc_Table: Parâmetro_Data (Table: Parâmetro_Data)</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario (Table: dCalendario)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
<li>Column: DT FATURAMENTO (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li>Calc_Column: Ano (Table: dCalendario)</li>
<li><span class="caret">Calc_Column: Trim (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: TrimNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: Dia_Num (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia da Semana (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: DiadaSemanNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Mês (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: MesNum (Table: dCalendario)</li>
</ul></li>
</ul></li>
<li>Calc_Column: Value4 (Table: Parâmetro_Data)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Título  - Data Fatutamento</td>
	</tr>
	<tr>
		<td>07_TopNProdutos</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>CALCULATE (
    [01_Total de Distribuições],
    KEEPFILTERS (
        TOPN (
            TopProdutos[TopProdutos Valor],
            ALL ( '01_Mapa Distribuição'[DESC MATERIAL] ),
            [01_Total de Distribuições]
        )
    )
)</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 07_TopNProdutos</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Measure: 01_Total de Distribuições (Table: _Medidas)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li>Calc_Table: TopProdutos (Table: TopProdutos)</li>
<li><span class="caret">Measure: TopProdutos Valor (Table: TopProdutos)</span>
<ul class="nested">
<li>Calc_Table: TopProdutos (Table: TopProdutos)</li>
<li>Calc_Column: TopProdutos (Table: TopProdutos)</li>
</ul></li>
<li>Column: DESC MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 07_TopNProdutos</span><span class="dropDownCaret">
<ul class="nested">
<li>Measure: 10_Destacar Maior Material Distribuído</li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>T&#237;tulo 3 - Top 10 Materiais</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"TOP "
    & SELECTEDVALUE ( TopProdutos[TopProdutos] ) & " Materiais com mais distribuições"</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Título 3 - Top 10 Materiais</span><span class="dropDownCaret">
<ul class="nested">
<li>Calc_Table: TopProdutos (Table: TopProdutos)</li>
<li>Calc_Column: TopProdutos (Table: TopProdutos)</li>
</ul></span></li>
</ul></td>
		<td>Measure: Título 3 - Top 10 Materiais</td>
	</tr>
	<tr>
		<td>08_%T Distribui&#231;&#227;o</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DIVIDE (
    [01_Total de Distribuições],
    CALCULATE (
        [01_Total de Distribuições],
        ALL ( '01_Mapa Distribuição' )
    )
)</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 08_%T Distribuição</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Measure: 01_Total de Distribuições (Table: _Medidas)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 08_%T Distribuição</td>
	</tr>
	<tr>
		<td>11_Destacar Maior Data Distribui&#231;&#227;o</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>VAR COR_DESTAQUE = "#094780"
VAR COR_PADRAO = "#CCD5EB"
VAR VMAIORANO =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Ano] ),
            [01_Total de Distribuições]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORTRI =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Trim] ),
            [01_Total de Distribuições]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORMES =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Mês] ),
            [01_Total de Distribuições]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORDIA =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Dia] ),
            [01_Total de Distribuições]
        ),
        ALLSELECTED ( dCalendario )
    )
VAR VMAIORDIADASEMANA =
    CALCULATE (
        MAXX (
            VALUES ( dCalendario[Dia da Semana] ),
            [01_Total de Distribuições]
        ),
        ALLSELECTED ( dCalendario )
    )
RETURN
    SWITCH (
        TRUE (),
        ISINSCOPE ( dCalendario[Dia] )
            && [01_Total de Distribuições] = VMAIORDIA, COR_DESTAQUE,
        [01_Total de Distribuições] = VMAIORANO, COR_DESTAQUE,
        [01_Total de Distribuições] = VMAIORMES, COR_DESTAQUE,
        [01_Total de Distribuições] = VMAIORTRI, COR_DESTAQUE,
        [01_Total de Distribuições] = VMAIORDIADASEMANA, COR_DESTAQUE,
        COR_PADRAO
    )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 11_Destacar Maior Data Distribuição</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: 01_Total de Distribuições (Table: _Medidas)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario (Table: dCalendario)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
<li>Column: DT FATURAMENTO (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li>Calc_Column: Ano (Table: dCalendario)</li>
<li><span class="caret">Calc_Column: Trim (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: TrimNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: Dia_Num (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Dia da Semana (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: DiadaSemanNum (Table: dCalendario)</li>
</ul></li>
<li><span class="caret">Calc_Column: Mês (Table: dCalendario)</span>
<ul class="nested">
<li>Attribute_Hierarchy: MesNum (Table: dCalendario)</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td>Measure: 11_Destacar Maior Data Distribuição</td>
	</tr>
	<tr>
		<td>10_Destacar Maior Material Distribu&#237;do</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>VAR vMaiorMaterial =
    CALCULATE (
        MAXX (
            VALUES ( '01_Mapa Distribuição'[DESC MATERIAL] ),
            [07_TopNProdutos]
        ),
        ALLSELECTED ( '01_Mapa Distribuição' )
    )
RETURN
    SWITCH (
        TRUE (),
        [07_TopNProdutos] = vMaiorMaterial, "#094780",
        "#CCD5EB"
    )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 10_Destacar Maior Material Distribuído</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Measure: 07_TopNProdutos (Table: _Medidas)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Measure: 01_Total de Distribuições (Table: _Medidas)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li>Calc_Table: TopProdutos (Table: TopProdutos)</li>
<li><span class="caret">Measure: TopProdutos Valor (Table: TopProdutos)</span>
<ul class="nested">
<li>Calc_Table: TopProdutos (Table: TopProdutos)</li>
<li>Calc_Column: TopProdutos (Table: TopProdutos)</li>
</ul></li>
<li>Column: DESC MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li>Column: DESC MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 10_Destacar Maior Material Distribuído</td>
	</tr>
	<tr>
		<td>09_Destacar Maior Cliente com Distribui&#231;&#227;o</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>VAR vMaiorMaterial =
    CALCULATE (
        MAXX (
            VALUES ( '01_Mapa Distribuição'[CLIENTE] ),
            [06_TopNClientes]
        ),
        ALLSELECTED ( '01_Mapa Distribuição' )
    )
RETURN
    SWITCH (
        TRUE (),
        [06_TopNClientes] = vMaiorMaterial, "#094780",
        "#CCD5EB"
    )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 09_Destacar Maior Cliente com Distribuição</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Measure: 06_TopNClientes (Table: _Medidas)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li><span class="caret">Measure: 01_Total de Distribuições (Table: _Medidas)</span>
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: COD MATERIAL (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li>Calc_Table: TopnClientes (Table: TopnClientes)</li>
<li><span class="caret">Measure: Topn Valor (Table: TopnClientes)</span>
<ul class="nested">
<li>Calc_Table: TopnClientes (Table: TopnClientes)</li>
<li>Calc_Column: Topn (Table: TopnClientes)</li>
</ul></li>
<li>Column: CLIENTE (Table: 01_Mapa Distribuição)</li>
</ul></li>
<li>Column: CLIENTE (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 09_Destacar Maior Cliente com Distribuição</td>
	</tr>
	<tr>
		<td>12_Per&#237;odo do Faturamento</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Período Faturamento: "
    & MIN ( '01_Mapa Distribuição'[DT FATURAMENTO] ) & " a "
    & MAX ( '01_Mapa Distribuição'[DT FATURAMENTO] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 12_Período do Faturamento</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: DT FATURAMENTO (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 12_Período do Faturamento</td>
	</tr>
	<tr>
		<td>04_Total NFE</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>DISTINCTCOUNT ( '01_Mapa Distribuição'[NF] ) + 0</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: 04_Total NFE</span><span class="dropDownCaret">
<ul class="nested">
<li>Table: 01_Mapa Distribuição</li>
<li>Column: NF (Table: 01_Mapa Distribuição)</li>
</ul></span></li>
</ul></td>
		<td>Measure: 04_Total NFE</td>
	</tr>
	<tr>
		<td>13_Data/Hora</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>NOW () - 3 / 24</pre></td>
		<td>Measure: 13_Data/Hora</td>
		<td>Measure: 13_Data/Hora</td>
	</tr>
	<tr>
		<td>14_Usu&#225;rio</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>USERPRINCIPALNAME ()</pre></td>
		<td>Measure: 14_Usuário</td>
		<td>Measure: 14_Usuário</td>
	</tr>
	<tr>
		<td>&#218;ltima atualiza&#231;&#227;o</td>
		<td>_Medidas</td>
		<td></td>
		<td><pre>"Última atualização agendada: "
    & SELECTEDVALUE ( 'Última Atualização'[Última Atualização] )</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Última atualização</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Table: Última Atualização</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></li>
<li><span class="caret">Column: Última Atualização (Table: Última Atualização)</span>
<ul class="nested">
<li>Table: Última Atualização   ...</li>
<li>Column: Última Atualização (Table: Última Atualização)   ...</li>
</ul></li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Última atualização</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Calc_Table: Parametro Data Faturamento</li>
<li>Measure: 11_Destacar Maior Data Distribuição</li>
<li><span class="caret">Calc_Table: Parâmetro_Data</span>
<ul class="nested">
<li>Measure: Título  - Data Fatutamento</li>
</ul></li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Calc_Table: Parametro Data Faturamento</li>
<li>Measure: 11_Destacar Maior Data Distribuição</li>
<li><span class="caret">Calc_Table: Parâmetro_Data</span>
<ul class="nested">
<li>Measure: Título  - Data Fatutamento</li>
</ul></li>
</ul></li>
<li><span class="caret">Measure: Última atualização</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Calc_Table: Parametro Data Faturamento</li>
<li>Measure: 11_Destacar Maior Data Distribuição</li>
<li><span class="caret">Calc_Table: Parâmetro_Data</span>
<ul class="nested">
<li>Measure: Título  - Data Fatutamento</li>
</ul></li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Calc_Table: Parametro Data Faturamento</li>
<li>Measure: 11_Destacar Maior Data Distribuição</li>
<li><span class="caret">Calc_Table: Parâmetro_Data</span>
<ul class="nested">
<li>Measure: Título  - Data Fatutamento</li>
</ul></li>
</ul></li>
<li>Measure: Última atualização ...</li>
<li>Measure: Última atualização ...</li>
</ul></li>
<li><span class="caret">Measure: Última atualização</span>
<ul class="nested">
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Calc_Table: Parametro Data Faturamento</li>
<li>Measure: 11_Destacar Maior Data Distribuição</li>
<li><span class="caret">Calc_Table: Parâmetro_Data</span>
<ul class="nested">
<li>Measure: Título  - Data Fatutamento</li>
</ul></li>
</ul></li>
<li><span class="caret">Calc_Table: dCalendario</span>
<ul class="nested">
<li>Calc_Table: Parametro Data Faturamento</li>
<li>Measure: 11_Destacar Maior Data Distribuição</li>
<li><span class="caret">Calc_Table: Parâmetro_Data</span>
<ul class="nested">
<li>Measure: Título  - Data Fatutamento</li>
</ul></li>
</ul></li>
<li>Measure: Última atualização ...</li>
<li>Measure: Última atualização ...</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>Topn Valor</td>
		<td>TopnClientes</td>
		<td></td>
		<td><pre>SELECTEDVALUE (
    'TopnClientes'[Topn],
    10
)</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Topn Valor</span><span class="dropDownCaret">
<ul class="nested">
<li>Calc_Table: TopnClientes (Table: TopnClientes)</li>
<li>Calc_Column: Topn (Table: TopnClientes)</li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: Topn Valor</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: 06_TopNClientes</span>
<ul class="nested">
<li>Measure: 09_Destacar Maior Cliente com Distribuição</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
	<tr>
		<td>TopProdutos Valor</td>
		<td>TopProdutos</td>
		<td></td>
		<td><pre>SELECTEDVALUE (
    'TopProdutos'[TopProdutos],
    10
)</pre></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: TopProdutos Valor</span><span class="dropDownCaret">
<ul class="nested">
<li>Calc_Table: TopProdutos (Table: TopProdutos)</li>
<li>Calc_Column: TopProdutos (Table: TopProdutos)</li>
</ul></span></li>
</ul></td>
		<td><ul id="myUL">
<li><span class="caret">Measure: TopProdutos Valor</span><span class="dropDownCaret">
<ul class="nested">
<li><span class="caret">Measure: 07_TopNProdutos</span>
<ul class="nested">
<li>Measure: 10_Destacar Maior Material Distribuído</li>
</ul></li>
</ul></span></li>
</ul></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table 01_Mapa Distribuição:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>COD MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DESC MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TIPO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DT FATURAMENTO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>QTD</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>UND</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>LOTE</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>COD CLIENTE</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CLIENTE</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TEL CONTATO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CNPJ</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CIDADE</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ESTADO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DOC MATERIAL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>NF</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>NF REMESSA</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TIPO MOVIMENTO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>ITEM</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>E-MAIL</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>CENTRO</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table _Medidas:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table TopnClientes:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Topn</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table dCalendario:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Date</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Ano</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>TrimNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Trim</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>MesNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>DiadaSemanNum</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia da Semana</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>M&#234;s</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Dia_Num</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Parametro Data Faturamento:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Par&#226;metro</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Par&#226;metro Campos</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Par&#226;metro Pedido</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Value4</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table TopProdutos:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>TopProdutos</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Última Atualização:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>&#218;ltima Atualiza&#231;&#227;o</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Columns for Table Parâmetro_Data:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Column Name</th>
		<th>Description</th>
		<th>Calculated Column</th>
		<th>Expression</th>
	</tr>
	<tr>
		<td>Par&#226;metro</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
	<tr>
		<td>Value4</td>
		<td></td>
		<td></td>
		<td></td>
	</tr>
</table>
<hr></hr><br></br><h3><div>List of Roles:</div></h3><br></br><table border="1" cellpadding="3">
	<tr>
		<th>Role Name</th>
		<th>Table Name</th>
		<th>Description</th>
		<th>Expression</th>
	</tr>
</table>
<hr></hr><br></br><h3><div>Relationships:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >CrossFilteringBehavior</td><td >FromCardinality</td><td >FromColumn</td><td >FromTable</td><td >IsActive</td><td >IsRemoved</td><td >JoinOnDateBehavior</td><td >RelyOnReferentialIntegrity</td><td >SecurityFilteringBehavior</td><td >State</td><td >ToCardinality</td><td >ToColumn</td><td >ToTable</td><td >Type</td></tr><tr ><td >6d51d8ee-bf82-4ba5-9ed0-be69bfc36523</td><td >OneDirection</td><td >Many</td><td >DT FATURAMENTO</td><td >01_Mapa Distribuição</td><td >True</td><td >False</td><td >DateAndTime</td><td >False</td><td >OneDirection</td><td >Ready</td><td >One</td><td >Date</td><td >dCalendario</td><td >SingleColumn</td></tr></table><hr></hr><br></br><h2><div>M (Power Query) Script:</div></h2><br></br><br></br><font face="verdana" size="2"<div>01_Mapa Distribuição-1890922c-ec34-400e-9bca-d343bd746564<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">AmazonRedshift.Database</font>("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com<font color="red">","</font>farmaxcluster"),<br></br>    qlt = Fonte{[Name=<font color="red">"qlt"</font>]}[Data],<br></br>    dim_distribuition_map = qlt{[Name=<font color="red">"dim_distribuition_map"</font>]}[Data],<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(dim_distribuition_map,{{<font color="red">"distribuition_map_cod_material"</font>, <font color="red">"COD MATERIAL"</font>}, {<font color="red">"distribuition_map_material"</font>, <font color="red">"DESC MATERIAL"</font>}, {<font color="red">"distribuition_map_tipo_produto"</font>, <font color="red">"TIPO"</font>}, {<font color="red">"distribuition_map_dt_faturamento"</font>, <font color="red">"DT FATURAMENTO"</font>}, {<font color="red">"distribuition_map_quantidade"</font>, <font color="red">"QTD"</font>}, {<font color="red">"distribuition_map_umb"</font>, <font color="red">"UND"</font>}, {<font color="red">"distribuition_map_lote"</font>, <font color="red">"LOTE"</font>}, {<font color="red">"distribuition_map_cod_cliente"</font>, <font color="red">"COD CLIENTE"</font>}, {<font color="red">"distribuition_map_cliente"</font>, <font color="red">"CLIENTE"</font>}, {<font color="red">"distribuition_map_tel_contato"</font>, <font color="red">"TEL CONTATO"</font>}, {<font color="red">"distribuition_map_cnpj_cliente"</font>, <font color="red">"CNPJ"</font>}, {<font color="red">"distribuition_map_cidade_cliente"</font>, <font color="red">"CIDADE"</font>}, {<font color="red">"distribuition_map_estado_cliente"</font>, <font color="red">"ESTADO"</font>}, {<font color="red">"distribuition_map_nfenum"</font>, <font color="red">"NF"</font>}, {<font color="red">"distribuition_map_nota_remessa"</font>, <font color="red">"NF REMESSA"</font>}, {<font color="red">"distribuition_map_cod_tipo_movimento"</font>, <font color="red">"TIPO MOVIMENTO"</font>}, {<font color="red">"distribuition_map_item"</font>, <font color="red">"ITEM"</font>}, {<font color="red">"distribuition_map_doc_material"</font>, <font color="red">"DOC MATERIAL"</font>}, {<font color="red">"distribuition_map_centro"</font>, <font color="red">"CENTRO"</font>},{<font color="red">"distribuition_map_email"</font>,"E-MAIL"}}),<br></br>    #<font color="red">"Linhas Filtradas"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Colunas Renomeadas"</font>, each <font color="blue">true</font>)<br></br><font color="blue">in</font><br></br>    #<font color="red">"Linhas Filtradas"</font><br></br><br></br><br></br>----------------------<br></br>_Medidas-25836cc0-4fe4-443c-9243-a1e7c0fcde31<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i44FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Coluna 1"</font> = _t]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Coluna 1"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Tipo Alterado"</font>,{<font color="red">"Coluna 1"</font>})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Removidas"</font><br></br><br></br><br></br>----------------------<br></br>TopnClientes-12bdf672-36b3-47b6-8499-61fe5aee2c59<br></br><br></br>GENERATESERIES(1, 10, 1) <br></br><br></br><br></br>----------------------<br></br>dCalendario-a97d2145-32cc-42a7-bd95-ae66279433a5<br></br><br></br>ADDCOLUMNS(<br></br>   CALENDARAUTO(),<br></br>    <font color="red">"Ano"</font>,YEAR([Date]),<br></br>    <font color="red">"TrimNum"</font>,QUARTER([Date]),<br></br>    <font color="red">"Trim"</font>,CONCATENATE("Trim-",QUARTER([Date])),<br></br>    <font color="red">"MesNum"</font>,MONTH([Date]),<br></br>    <font color="red">"Mês"</font>,FORMAT([Date],<font color="red">"mmm"</font>),<br></br>    <font color="red">"Dia_Num"</font>,DAY([Date]),<br></br>    <font color="red">"DiadaSemanNum"</font>,WEEKDAY([Date],1),<br></br>    <font color="red">"Dia da Semana"</font>,FORMAT([Date],<font color="red">"ddd"</font>),<br></br>    <font color="red">"Dia"</font>, CONCATENATE(<font color="red">""</font>,DAY([Date])))<font color="green">//Coluna criada para ordenar os dias nos visuais de período</font>
<br></br><br></br>----------------------<br></br>Parametro Data Faturamento-94615566-6a94-493d-8e99-994fdece58cb<br></br><br></br>{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]), 0,<font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]), 1,<font color="red">"Trim"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]), 2,<font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>,NAMEOF(dCalendario[Dia]),3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]), 4,<font color="red">"Dia da Semana"</font>)<br></br>}<br></br><br></br><br></br>----------------------<br></br>TopProdutos-29a97b2c-a311-41bb-acfd-aed459583136<br></br><br></br>GENERATESERIES(1, 10, 1)<br></br><br></br><br></br>----------------------<br></br>Última Atualização-6c4582a9-0cc1-4e20-9038-37b683820e5a<br></br><br></br><font color="blue">let</font><br></br>    Fonte = <font color="purple">DateTimeZone.SwitchZone</font>(<font color="purple">DateTimeZone.LocalNow</font>(),-4,0)<br></br><font color="blue">in</font><br></br>    Fonte<br></br><br></br><br></br>----------------------<br></br>Parâmetro_Data-0d1fced5-7216-4f29-827f-949c4858debc<br></br><br></br>{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]), 0,<font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]), 1,<font color="red">"Trim"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]), 2,<font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>, NAMEOF('dCalendario'[Dia]), 3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]), 4,<font color="red">"Dia da Semana"</font>)<br></br>}<br></br><br></br><br></br>----------------------<br></br></font></div><br></br><hr></hr><br></br><h3><div>Partitions:</div></h3><br></br><table border='1px' cellpadding='1' cellspacing='1'><tr ><td >Name</td><td >QueryDefinition</td></tr><tr ><td >01_Mapa Distribuição-1890922c-ec34-400e-9bca-d343bd746564</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">AmazonRedshift.Database</font>("farmax-cluster.cdkgzqhbae0k.us-east-1.redshift.amazonaws.com<font color="red">","</font>farmaxcluster"),<br></br>    qlt = Fonte{[Name=<font color="red">"qlt"</font>]}[Data],<br></br>    dim_distribuition_map = qlt{[Name=<font color="red">"dim_distribuition_map"</font>]}[Data],<br></br>    #<font color="red">"Colunas Renomeadas"</font> = <font color="purple">Table.RenameColumns</font>(dim_distribuition_map,{{<font color="red">"distribuition_map_cod_material"</font>, <font color="red">"COD MATERIAL"</font>}, {<font color="red">"distribuition_map_material"</font>, <font color="red">"DESC MATERIAL"</font>}, {<font color="red">"distribuition_map_tipo_produto"</font>, <font color="red">"TIPO"</font>}, {<font color="red">"distribuition_map_dt_faturamento"</font>, <font color="red">"DT FATURAMENTO"</font>}, {<font color="red">"distribuition_map_quantidade"</font>, <font color="red">"QTD"</font>}, {<font color="red">"distribuition_map_umb"</font>, <font color="red">"UND"</font>}, {<font color="red">"distribuition_map_lote"</font>, <font color="red">"LOTE"</font>}, {<font color="red">"distribuition_map_cod_cliente"</font>, <font color="red">"COD CLIENTE"</font>}, {<font color="red">"distribuition_map_cliente"</font>, <font color="red">"CLIENTE"</font>}, {<font color="red">"distribuition_map_tel_contato"</font>, <font color="red">"TEL CONTATO"</font>}, {<font color="red">"distribuition_map_cnpj_cliente"</font>, <font color="red">"CNPJ"</font>}, {<font color="red">"distribuition_map_cidade_cliente"</font>, <font color="red">"CIDADE"</font>}, {<font color="red">"distribuition_map_estado_cliente"</font>, <font color="red">"ESTADO"</font>}, {<font color="red">"distribuition_map_nfenum"</font>, <font color="red">"NF"</font>}, {<font color="red">"distribuition_map_nota_remessa"</font>, <font color="red">"NF REMESSA"</font>}, {<font color="red">"distribuition_map_cod_tipo_movimento"</font>, <font color="red">"TIPO MOVIMENTO"</font>}, {<font color="red">"distribuition_map_item"</font>, <font color="red">"ITEM"</font>}, {<font color="red">"distribuition_map_doc_material"</font>, <font color="red">"DOC MATERIAL"</font>}, {<font color="red">"distribuition_map_centro"</font>, <font color="red">"CENTRO"</font>},{<font color="red">"distribuition_map_email"</font>,"E-MAIL"}}),<br></br>    #<font color="red">"Linhas Filtradas"</font> = <font color="purple">Table.SelectRows</font>(#<font color="red">"Colunas Renomeadas"</font>, each <font color="blue">true</font>)<br></br><font color="blue">in</font><br></br>    #<font color="red">"Linhas Filtradas"</font></td></tr><tr ><td >_Medidas-25836cc0-4fe4-443c-9243-a1e7c0fcde31</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">Table.FromRows</font>(<font color="purple">Json.Document</font>(<font color="purple">Binary.Decompress</font>(<font color="purple">Binary.From</font>Text("i44FAA==", <font color="purple">BinaryEncoding.Base64</font>), <font color="purple">Compression.Deflate</font>)), <font color="blue">let</font> _t = ((<font color="blue">type</font> nullable <font color="blue">text</font>) meta [Serialized.Text = <font color="blue">true</font>]) <font color="blue">in</font> <font color="blue">type</font> table [#<font color="red">"Coluna 1"</font> = _t]),<br></br>    #<font color="red">"Tipo Alterado"</font> = <font color="purple">Table.TransformColumnTypes</font>(Fonte,{{<font color="red">"Coluna 1"</font>, <font color="blue">type</font> <font color="blue">text</font>}}),<br></br>    #<font color="red">"Colunas Removidas"</font> = <font color="purple">Table.RemoveColumns</font>(#<font color="red">"Tipo Alterado"</font>,{<font color="red">"Coluna 1"</font>})<br></br><font color="blue">in</font><br></br>    #<font color="red">"Colunas Removidas"</font></td></tr><tr ><td >TopnClientes-12bdf672-36b3-47b6-8499-61fe5aee2c59</td><td >GENERATESERIES(1, 10, 1) </td></tr><tr ><td >dCalendario-a97d2145-32cc-42a7-bd95-ae66279433a5</td><td >ADDCOLUMNS(<br></br>   CALENDARAUTO(),<br></br>    <font color="red">"Ano"</font>,YEAR([Date]),<br></br>    <font color="red">"TrimNum"</font>,QUARTER([Date]),<br></br>    <font color="red">"Trim"</font>,CONCATENATE("Trim-",QUARTER([Date])),<br></br>    <font color="red">"MesNum"</font>,MONTH([Date]),<br></br>    <font color="red">"Mês"</font>,FORMAT([Date],<font color="red">"mmm"</font>),<br></br>    <font color="red">"Dia_Num"</font>,DAY([Date]),<br></br>    <font color="red">"DiadaSemanNum"</font>,WEEKDAY([Date],1),<br></br>    <font color="red">"Dia da Semana"</font>,FORMAT([Date],<font color="red">"ddd"</font>),<br></br>    <font color="red">"Dia"</font>, CONCATENATE(<font color="red">""</font>,DAY([Date])))<font color="green">//Coluna criada para ordenar os dias nos visuais de período</font></td></tr><tr ><td >Parametro Data Faturamento-94615566-6a94-493d-8e99-994fdece58cb</td><td >{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]), 0,<font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]), 1,<font color="red">"Trim"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]), 2,<font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>,NAMEOF(dCalendario[Dia]),3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]), 4,<font color="red">"Dia da Semana"</font>)<br></br>}</td></tr><tr ><td >TopProdutos-29a97b2c-a311-41bb-acfd-aed459583136</td><td >GENERATESERIES(1, 10, 1)</td></tr><tr ><td >Última Atualização-6c4582a9-0cc1-4e20-9038-37b683820e5a</td><td ><font color="blue">let</font><br></br>    Fonte = <font color="purple">DateTimeZone.SwitchZone</font>(<font color="purple">DateTimeZone.LocalNow</font>(),-4,0)<br></br><font color="blue">in</font><br></br>    Fonte</td></tr><tr ><td >Parâmetro_Data-0d1fced5-7216-4f29-827f-949c4858debc</td><td >{<br></br>    (<font color="red">"Ano"</font>, NAMEOF('dCalendario'[Ano]), 0,<font color="red">"Ano"</font>),<br></br>    (<font color="red">"Trim"</font>, NAMEOF('dCalendario'[Trim]), 1,<font color="red">"Trim"</font>),<br></br>    (<font color="red">"Mês"</font>, NAMEOF('dCalendario'[Mês]), 2,<font color="red">"Mês"</font>),<br></br>    (<font color="red">"Dia"</font>, NAMEOF('dCalendario'[Dia]), 3,<font color="red">"Dia"</font>),<br></br>    (<font color="red">"Dia da Semana"</font>, NAMEOF('dCalendario'[Dia da Semana]), 4,<font color="red">"Dia da Semana"</font>)<br></br>}</td></tr></table><script>
	var toggler = document.getElementsByClassName("caret");
	for (var i = 0; i < toggler.length; i++){
		toggler[i].addEventListener("click", function() {
			this.parentElement.querySelector(".nested").classList.toggle("active");
		});
	}
		
	var togglerAll = document.getElementsByClassName("dropDownCaret");
	for (var j=0; j<togglerAll.length; j++){
		togglerAll[j].addEventListener("click", function(event){
			if (event.currentTarget != event.target) return;
			if(this.parentElement.querySelector(".nested").classList.contains("active")){
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(currentValue.classList.contains("active")){
						currentValue.classList.remove("active");
					}
				});
			}
			else{
				this.querySelectorAll(".nested").forEach(function(currentValue, currentIndex, listObj) {
					if(!currentValue.classList.contains("active")){
						currentValue.classList.add("active");
					}
				});
			}
		});
	}
</script></body></html>